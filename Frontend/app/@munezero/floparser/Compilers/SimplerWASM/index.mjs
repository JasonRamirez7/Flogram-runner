var _c="as",Oc="=",bc="break",dc="else",mc="enum",Tc="export",gc="if",yc="import",xc="->",Ic="is",Ac="loop",Nc="mut",Rc="native",Sc="object",Pc="fn",zc="return",jc="self",Cc="template",Fc=Object.freeze({ALIAS:_c,ASSIGN:Oc,BREAK:bc,ELSE:dc,ENUMERATION:mc,EXPORT:Tc,IF:gc,IMPORT:yc,INTO:xc,IS:Ic,LOOP:Ac,MUTABLE:Nc,NATIVE:Rc,OBJECT:Sc,PROCEDURE:Pc,RETURN:zc,SELF:jc,TEMPLATE:Cc}),$n=Fc;var Dc="assign",Uc="arity_match",kc="arity_status",Lc="array_assignment",Yc="branch-match",wc="branch-default",Vc="condition",vc="loop",Mc="data",Bc="generics",Kc="enumeration",Gc="expression",Hc="instance",Zc="Link",Xc="local",Wc="object",qc="procedure",$c="return",Jc="compare",Qc="select",ea="member",ta="store",sa="break",na="literal",oa="array_access",ca="valueLink",aa="linkValue",ra="self",ia="procedure-call",pa="Maybe",la="native",ua="move",fa="String",ha="Array",Ea="import",_a="library",Oa="constructor",ba="destructor",da="free",ma="block-end",Ta="default-block",ga="continue",ya="branch",xa="statement",Ia="draw",Aa="now",Na="size",Ra="concatenation",Sa="foreach",Pa="while",za="when",ja="while-condition",Ca="foreach-condition",Fa="foreach-end",Da="for",Ua="up_to",ka="down_to",La="almost_up_to",Ya="almost_down_to",wa="I32",Va="U32",va="FP32",Ma="I16",Ba="U16",Ka="U8",Ga="I8",Ha="FP64",Za="U64",Xa="I64",Wa="Char",qa="block-start",$a="function-call",Ja="Bool",Qa=Object.freeze({TYPES_ASSIGN:Dc,TYPES_ARRAY:ha,TYPES_ARITY_MATCH:Uc,TYPES_ARITY_STATUS:kc,TYPES_ARRAY_ASSIGNMENT:Lc,TYPES_BRANCH_MATCH:Yc,TYPES_BRANCH_DEFAULT:wc,TYPES_CONDITION:Vc,TYPES_LOOP:vc,TYPES_FOREACH_END:Fa,TYPES_WHILE_CONDITION:ja,TYPES_FOREACH_CONDITION:Ca,TYPES_DATA:Mc,TYPES_COMPARE:Jc,TYPES_GENERICS:Bc,TYPES_ENUMERATION:Kc,TYPES_EXPRESSION:Gc,TYPES_INSTANCE:Hc,TYPES_LINK:Zc,TYPES_IMPORT:Ea,TYPES_LOCAL:Xc,TYPES_OBJECT:Wc,TYPES_PROCEDURE:qc,TYPES_RETURN:$c,TYPES_SELECT:Qc,TYPES_MEMBER:ea,TYPES_STORE:ta,TYPES_BREAK:sa,TYPES_LITERAL:na,TYPES_ARRAY_ACCESS:oa,TYPES_LINK_TO:ca,TYPES_VALUE_AT:aa,TYPES_SELF:ra,TYPES_LIBRARY:_a,TYPES_DROP:ia,TYPES_MAYBE:pa,TYPES_NATIVE:la,TYPES_MOVE:ua,TYPES_STRING:fa,TYPES_CONSTRUCTOR:Oa,TYPES_FREE:da,TYPES_DEFAULT_BLOCK:Ta,TYPES_BLOCK_END:ma,TYPES_CONTINUE:ga,TYPES_BRANCH:ya,TYPES_STATEMENT:xa,TYPES_DESTRUCTOR:ba,TYPES_DRAW:Ia,TYPES_NOW:Aa,TYPES_SIZE:Na,TYPES_CONCAT:Ra,TYPES_FOREACH:Sa,TYPES_WHILE:Pa,TYPES_WHEN:za,TYPES_FOR:Da,TYPES_UP_TO:Ua,TYPES_DOWN_TO:ka,TYPES_ALMOST_UP_TO:La,TYPES_ALMOST_DOWN_TO:Ya,TYPES_I32:wa,TYPES_FP32:va,TYPES_FP64:Ha,TYPES_U32:Va,TYPES_I64:Xa,TYPES_U64:Za,TYPES_I16:Ma,TYPES_U16:Ba,TYPES_I8:Ga,TYPES_U8:Ka,TYPES_CHAR:Wa,TYPES_BOOL:Ja,TYPES_BLOCK_BEGIN:qa,TYPES_FUNCTION_CALL:$a}),tn=Qa;var er=Object.freeze({COLON:58,COMMA:44,DIGIT_ZERO:48,DIGIT_NINE:57,DOT:46,HASHTAG:35,HORIZONTAL_TAB:9,HYPHEN_MINUS:45,LEFT_CURLY_BRACKET:123,LEFT_PARENTHESIS:40,LEFT_SQUARE_BRACKET:91,LINE_BREAK:10,NULL:0,PLUS_SIGN:43,RIGHT_CURLY_BRACKET:125,RIGHT_PARENTHESIS:41,RIGHT_SQUARE_BRACKET:93,SEMICOLON:59,SPACE:32,E_SIGN:101}),Jn=er;var tr="assignment",sr="Flogram",nr=Object.freeze({K_ASSIGNMENT:tr,K_FLOGRAM:sr}),Qn=nr;var or=Object.freeze([[43],[45],[42],[47],[37],[110,111,116],[60],[62],[94],[111,114],[33],[61,61],[60,61],[62,61],[33,61],[120,111,114],[97,110,100]]),cr=or,eo=cr;var ar=Object.freeze({INT_ARRAY_START:9999991,FLOAT_ARRAY_START:9999981,STRING_START:8888891,CHAR_START:8888881,NAT_ON_HORIZON:7777791,BIG_NAT_ON_HORIZON:7777591,FLOAT_ON_HORIZON:7777771,BIG_FLOAT_ON_HORIZON:7777731,END_OF_LINE:66666661}),to=ar;var rr=Object.freeze({ENUM_MEMORY_SIZE:12,ENUM_STACK_SIZE:3,ARRAY_MEMORY_SIZE:12,ARRAY_STACK_SIZE:3,ARRAY_DEFAULT_CAPACITY:4,STRING_MEMORY_SIZE:8,STRING_STACK_SIZE:2,OBJECT_MEMORY_SIZE:8,OBJECT_STACK_SIZE:2,NATIVE_MEMORY_SIZE:4,NATIVE_STACK_SIZE:1,NATIVE_SIZE:4,STEP:4,DOUBLE_STEP:8,TRIPPLE_STEP:12}),so=rr;var ir=Object.freeze([]),pr=Object.freeze({}),lr="",ur="	",fr=`
`,hr="UTF-8",Ns=tn,Er=Object.freeze({EMPTY_ARRAY:ir,EMPTY_OBJECT:pr,EMPTY_STRING:lr,HORIZONTAL_TAB:ur,LINE_BREAK:fr,UNICODE_TEXT:hr,Codes:Jn,Keys:$n,Types:tn,Keywords:Qn,Operators:eo,DrawStates:to,Sizes:so}),Rt=Er;var _r=Object.freeze(["FP64","U64","I64","FP32","U32","I32","U16","I16","U8","I8","Bool","Char","Array","String","Link","Maybe"]),qt=["U8","U16","U32"],ps=[...qt,"I8","I16","I32"],sn=["I64","U64"],ls=[...ps,...sn],Rs=["FP32","FP64"],us=[...ls,...Rs],fs=_r;var{EMPTY_STRING:Or,UNICODE_TEXT:an}=Rt;var br=48,dr=57,mr=46,no=45,oo=43,Tr=65,gr=90,yr="e".charCodeAt(0),xr="E".charCodeAt(0),Ir=-1,Ar=1,co=new TextDecoder(an),Nr=new TextEncoder,Rr=Rt.Operators,Sr=(c,s,r=0,h=c.length|0,D=0,ce=s.length|0)=>{for(D=D|0,r=r|0,ce=ce|0,h=h|0;;){let e=r>=h,pe=D>=ce;if(e||pe)break;let Oe=c[r],$=s[D];if(r=r+1|0,D=D+1|0,Oe<$)return Ir;if(Oe>$)return Ar}return 0},Pr=(c,s,r=0,h=c.length|0,D=0,ce=s.length|0)=>{for(D=D|0,r=r|0,ce=ce|0,h=h|0;;){let e=D>=ce,pe=r>=h;if(e||pe)break;s[D]=c[r],D=D+1|0,r=r+1|0}},io=(c,s,r=0,h=c.length|0,D=0,ce=s.length|0)=>{r=r|0,D=D|0,h=h|0,ce=ce|0;let e=h-r|0,pe=ce-D|0;if(e!==pe)return!1;for(;;){let me=r>=h,Oe=D>=ce;if(me||Oe)break;let Re=c[r],lt=s[D];if(r=r+1|0,D=D+1|0,Re!==lt)return!1}return!0},zr=c=>{c=c>>>0;let s=0,r=0;for(;r=(r<<1|1)>>>0,!(r>c);)s=s+1|0;return s},po=Object.freeze([48,49,50,51,52,53,54,55,56,57,97,98,99,100,101,102]),cn=(c,s,r,h)=>{for(c=c>>>0,h=h??s.length|0,r=r|0,h=h|0;c>0&&h>r;)h=h-1|0,s[h]=po[c&15],c=c>>>4},jr=(c,s,r,h)=>{let D=r|0,ce=r+h|0;if(h===0)return!1;let e=!1,pe=!1,me=!1,Oe=$=>$===oo||$===no;for(;D<ce;){let $=s[D];D=D+1|0;let Re=br<=$&&$<=dr,lt=oo===$||$===no,ut=mr===$,Ye=Br===$,nt=$===yr||$===xr;if(Re){me=!0;continue}else if(lt){if((D===r+1||e&&!pe)&&!me)continue}else if((Ye||ut)&&!e&&!pe||nt&&!e)nt&&(e=!0,D<ce&&Oe(s[D])&&(D=D+1|0,pe=!0));else return!1}return me&&(!e||e&&pe)},Cr={I8:[...ps],U8:[...qt],I16:[...ps],U16:[...qt],I32:[...ps],U32:[...qt],I64:[...ls],U64:[...qt],FP32:us,FP64:us},Fr=(c,s)=>!us.includes(c)||!us.includes(s)?!1:Cr[c].includes(s),Dr=c=>{let s=c>=Tr,r=c<=gr;return s&&r},Ps=128,zs=127,lo=-1,$t=64,rn=c=>{c=c|0;let s=[];for(;;){let r=c&zs;c=c>>7;let h=c===0,D=(r&$t)===0,ce=h&&D,e=c===-1,pe=(r&$t)!==0;if(ce||e&&pe){s.push(r);break}r=r|Ps,s.push(r)}return s},Ur=c=>{let s=[],r=!0;for(;r;){let h=c&zs;c>>=7,c===0&&!(h&$t)||c===-1&&h&$t?r=!1:h|=Ps,s.push(h)}return s},uo=(c,s)=>{s=s|0;let r=0,h=0;for(;;){let D=c[s]|0;s=s+1|0;let ce=(D&zs)<<h;if(h=h+7|0,r=r|ce,(D&Ps)===0){let pe=(D&$t)!==0,me=h<32;if(pe&&me){let $=lo<<h;r=r|$}break}}return r},kr=(c,s)=>{s=s|0;let r=0,h=0;for(;;){let D=c[s]|0;s=s+1|0;let ce=(D&zs)<<h;if(h=h+7|0,r=r|ce,!(D&Ps)){if(D&$t){let e=lo<<h;r=r|e}break}}return r},Lr=c=>{try{return co.decode(c)}catch{return co.decode(new Uint8Array([c]))}},Yr=c=>Nr.encode(c),wr=(c=Or)=>{let s=c.length|0,r=rn(s),h=Buffer.from(c,an);return Object.freeze([...r,...h])},Vr=(c,s)=>{s=s|0;let r=uo(c,s),h=rn(r).length;return s=s+h|0,c.subarray(s,s+r|0).toString(an)},vr=58,Mr=46,Br=95,hs=32,nn=48,Kr=67,Ut=new Uint8Array(Kr),ao=Ut.subarray(0,8),Ss=Ut.subarray(10,49),ro=Ut.subarray(51,68),on=16,Gr=2;Ut[8]=vr;Ut[9]=hs;Ut[49]=hs;Ut[50]=hs;var Hr=(c,s)=>{s=s??console.log;let r=32,h=126,D=c.length|0,ce=0;for(;D>0;){ao.fill(nn),cn(ce,ao),Ss.fill(hs),ro.fill(hs);let e=D>=on?on:D;D=D-on|0;let pe=0,me=0;for(let $=1;$<=e;$=$+1|0){let Re=c[ce]&255;Ss[pe+0|0]=nn,Ss[pe+1|0]=nn,cn(Re,Ss,pe,pe+2|0);let lt=Mr;r<=Re&&Re<=h&&(lt=Re),ro[me]=lt,ce=ce+1|0,pe=pe+2|0,me=me+1|0,$%Gr===0&&(pe=pe+1|0)}let Oe=String.fromCodePoint(...Ut);s(Oe)}},Zr=function*(c,s){let r=c.length|0,h=s.length|0,D=0;for(;D<r&&D<h;){let ce=c[D],e=s[D];yield[ce,e],D=D+1|0}},Xr=function*(c,s,r){let h=c.length|0,D=s.length|0,ce=r.length|0,e=0;for(;e<h&&e<D&&e<ce;){let pe=c[e],me=s[e],Oe=r[e];yield[pe,me,Oe],e=e+1|0}},Wr=c=>{for(let s of Rr)if(io(c,s))return!0;return!1},qr=Object.freeze({ARRAY_COMPARE:Sr,ARRAY_COPY:Pr,ARRAY_EQUAL:io,BIT_DEPTH:zr,HEX_DIGITS:po,HEX_ENCODE:cn,IS_NUMBER:jr,IS_UPPERCASE:Dr,IS_VALID_AUTO_CAST:Fr,LEB128_DECODE:uo,LEB128_DECODE_SIGNED:kr,LEB128_ENCODE:rn,LEB128_ENCODE_SIGNED:Ur,UTF8_DECODE:Lr,UTF8_ENCODE:Yr,WASM_STRING_ENCODE:wr,WASM_STRING_DECODE:Vr,XXD_DUMP_HEX:Hr,ZIP2:Zr,ZIP3:Xr,IS_OPERATOR:Wr}),Jt=qr;var ct=(c,s=2)=>{let r="";switch(c){case"+":r="add";break;case"-":r=s===2?"sub":"neg";break;case"*":r="mul";break;case"/":r="div";break;case"%":r="rem";break;case"==":r="eq";break;case">":r="gt";break;case"<":r="lt";break;case">=":r="ge";break;case"<=":r="le";break;case"!=":r="ne";break;case"and":r="and";break;case"or":r="or";break;case"xor":r="xor";break;case"not":r="not";break;case"I32":r="toi32";break;case"U32":r="tou32";break;case"I64":r="toi64";break;case"U64":r="tou64";break;case"FP64":r="tofp64";break;case"FP32":r="tofp32";break}return r};var $r=Object.freeze({type:"native",body:Object.freeze([160]),lengths:Object.freeze({inputs:2,outputs:1})}),Jr=Object.freeze({type:"native",body:Object.freeze([163]),lengths:Object.freeze({inputs:2,outputs:1})}),Qr=Object.freeze({type:"native",body:Object.freeze([162]),lengths:Object.freeze({inputs:2,outputs:1})}),ei=Object.freeze({type:"native",body:Object.freeze([68,0,0,0,0,0,0,240,191,162]),lengths:Object.freeze({inputs:1,outputs:1})}),ti=Object.freeze({type:"native",body:Object.freeze([161]),lengths:Object.freeze({inputs:2,outputs:1})}),si=Object.freeze({type:"native",body:Object.freeze([124]),lengths:Object.freeze({inputs:2,outputs:1})}),ni=Object.freeze({type:"native",body:Object.freeze([128]),lengths:Object.freeze({inputs:2,outputs:1})}),oi=Object.freeze({type:"native",body:Object.freeze([126]),lengths:Object.freeze({inputs:2,outputs:1})}),ci=Object.freeze({type:"native",body:Object.freeze([66,255,255,255,255,255,255,255,255,126]),lengths:Object.freeze({inputs:1,outputs:1})}),ai=Object.freeze({type:"native",body:Object.freeze([125]),lengths:Object.freeze({inputs:2,outputs:1})}),ri=Object.freeze({type:"native",body:Object.freeze([124]),lengths:Object.freeze({inputs:2,outputs:1})}),ii=Object.freeze({type:"native",body:Object.freeze([127]),lengths:Object.freeze({inputs:2,outputs:1})}),pi=Object.freeze({type:"native",body:Object.freeze([126]),lengths:Object.freeze({inputs:2,outputs:1})}),xu=Object.freeze({type:"native",body:Object.freeze([66,255,255,255,255,255,255,255,255,126]),lengths:Object.freeze({inputs:2,outputs:1})}),li=Object.freeze({type:"native",body:Object.freeze([125]),lengths:Object.freeze({inputs:2,outputs:1})}),fo=Object.freeze({type:"native",body:Object.freeze([146]),lengths:Object.freeze({inputs:2,outputs:1})}),ho=Object.freeze({type:"native",body:Object.freeze([149]),lengths:Object.freeze({inputs:2,outputs:1})}),Eo=Object.freeze({type:"native",body:Object.freeze([148]),lengths:Object.freeze({inputs:2,outputs:1})}),ui=Object.freeze({type:"native",body:Object.freeze([67,0,0,128,191,148]),lengths:Object.freeze({inputs:2,outputs:1})}),_o=Object.freeze({type:"native",body:Object.freeze([140]),lengths:Object.freeze({inputs:2,outputs:1})}),pn=Object.freeze({type:"native",body:Object.freeze([106]),lengths:Object.freeze({inputs:2,outputs:1})}),ln=Object.freeze({type:"native",body:Object.freeze([110]),lengths:Object.freeze({inputs:2,outputs:1})}),un=Object.freeze({type:"native",body:Object.freeze([108]),lengths:Object.freeze({inputs:2,outputs:1})}),fn=Object.freeze({type:"native",body:Object.freeze([107]),lengths:Object.freeze({inputs:2,outputs:1})}),hn=Object.freeze({type:"native",body:Object.freeze([106]),lengths:Object.freeze({inputs:2,outputs:1})}),En=Object.freeze({type:"native",body:Object.freeze([109]),lengths:Object.freeze({inputs:2,outputs:1})}),_n=Object.freeze({type:"native",body:Object.freeze([108]),lengths:Object.freeze({inputs:2,outputs:1})}),On=Object.freeze({type:"native",body:Object.freeze([65,1,0,0,0,108]),lengths:Object.freeze({inputs:1,outputs:1})}),bn=Object.freeze({type:"native",body:Object.freeze([107]),lengths:Object.freeze({inputs:2,outputs:1})}),fi=Object.freeze({type:"native",body:Object.freeze([130]),lengths:Object.freeze({inputs:2,outputs:1})}),hi=Object.freeze({type:"native",body:Object.freeze([129]),lengths:Object.freeze({inputs:2,outputs:1})}),dn=Object.freeze({type:"native",body:Object.freeze([112]),lengths:Object.freeze({inputs:2,outputs:1})}),mn=Object.freeze({type:"native",body:Object.freeze([111]),lengths:Object.freeze({inputs:2,outputs:1})}),Ei=Object.freeze({type:"native",body:Object.freeze([86]),lengths:Object.freeze({inputs:2,outputs:1})}),_i=Object.freeze({type:"native",body:Object.freeze([85]),lengths:Object.freeze({inputs:2,outputs:1})}),Oi=Object.freeze({type:"native",body:Object.freeze([100]),lengths:Object.freeze({inputs:2,outputs:1})}),js=Object.freeze({type:"native",body:Object.freeze([75]),lengths:Object.freeze({inputs:2,outputs:1})}),Tn=Object.freeze({type:"native",body:Object.freeze([74]),lengths:Object.freeze({inputs:2,outputs:1})}),bi=Object.freeze({type:"native",body:Object.freeze([94]),lengths:Object.freeze({inputs:2,outputs:1})}),di=Object.freeze({type:"native",body:Object.freeze([84]),lengths:Object.freeze({inputs:2,outputs:1})}),mi=Object.freeze({type:"native",body:Object.freeze([83]),lengths:Object.freeze({inputs:2,outputs:1})}),Ti=Object.freeze({type:"native",body:Object.freeze([99]),lengths:Object.freeze({inputs:2,outputs:1})}),Cs=Object.freeze({type:"native",body:Object.freeze([73]),lengths:Object.freeze({inputs:2,outputs:1})}),gn=Object.freeze({type:"native",body:Object.freeze([72]),lengths:Object.freeze({inputs:2,outputs:1})}),gi=Object.freeze({type:"native",body:Object.freeze([93]),lengths:Object.freeze({inputs:2,outputs:1})}),yi=Object.freeze({type:"native",body:Object.freeze([87]),lengths:Object.freeze({inputs:2,outputs:1})}),xi=Object.freeze({type:"native",body:Object.freeze([88]),lengths:Object.freeze({inputs:2,outputs:1})}),Ii=Object.freeze({type:"native",body:Object.freeze([101]),lengths:Object.freeze({inputs:2,outputs:1})}),yn=Object.freeze({type:"native",body:Object.freeze([76]),lengths:Object.freeze({inputs:2,outputs:1})}),Fs=Object.freeze({type:"native",body:Object.freeze([77]),lengths:Object.freeze({inputs:2,outputs:1})}),Ai=Object.freeze({type:"native",body:Object.freeze([95]),lengths:Object.freeze({inputs:2,outputs:1})}),Ni=Object.freeze({type:"native",body:Object.freeze([89]),lengths:Object.freeze({inputs:2,outputs:1})}),Ri=Object.freeze({type:"native",body:Object.freeze([90]),lengths:Object.freeze({inputs:2,outputs:1})}),Si=Object.freeze({type:"native",body:Object.freeze([102]),lengths:Object.freeze({inputs:2,outputs:1})}),xn=Object.freeze({type:"native",body:Object.freeze([78]),lengths:Object.freeze({inputs:2,outputs:1})}),Ds=Object.freeze({type:"native",body:Object.freeze([79]),lengths:Object.freeze({inputs:2,outputs:1})}),Pi=Object.freeze({type:"native",body:Object.freeze([96]),lengths:Object.freeze({inputs:2,outputs:1})}),zi=Object.freeze({type:"native",body:Object.freeze([81]),lengths:Object.freeze({inputs:2,outputs:1})}),ji=Object.freeze({type:"native",body:Object.freeze([81]),lengths:Object.freeze({inputs:2,outputs:1})}),Ci=Object.freeze({type:"native",body:Object.freeze([97]),lengths:Object.freeze({inputs:2,outputs:1})}),In=Object.freeze({type:"native",body:Object.freeze([70]),lengths:Object.freeze({inputs:2,outputs:1})}),Es=Object.freeze({type:"native",body:Object.freeze([70]),lengths:Object.freeze({inputs:2,outputs:1})}),Fi=Object.freeze({type:"native",body:Object.freeze([91]),lengths:Object.freeze({inputs:2,outputs:1})}),Di=Object.freeze({type:"native",body:Object.freeze([82]),lengths:Object.freeze({inputs:2,outputs:1})}),Ui=Object.freeze({type:"native",body:Object.freeze([82]),lengths:Object.freeze({inputs:2,outputs:1})}),ki=Object.freeze({type:"native",body:Object.freeze([98]),lengths:Object.freeze({inputs:2,outputs:1})}),_s=Object.freeze({type:"native",body:Object.freeze([71]),lengths:Object.freeze({inputs:2,outputs:1})}),An=Object.freeze({type:"native",body:Object.freeze([71]),lengths:Object.freeze({inputs:2,outputs:1})}),Li=Object.freeze({type:"native",body:Object.freeze([92]),lengths:Object.freeze({inputs:2,outputs:1})}),Yi=Object.freeze({type:"native",body:Object.freeze([113]),lengths:Object.freeze({inputs:2,outputs:1})}),wi=Object.freeze({type:"native",body:Object.freeze([114]),lengths:Object.freeze({inputs:2,outputs:1})}),Vi=Object.freeze({type:"native",body:Object.freeze([115]),lengths:Object.freeze({inputs:2,outputs:1})}),vi=Object.freeze({type:"native",body:Object.freeze([69]),lengths:Object.freeze({inputs:1,outputs:1})}),Oo=Object.freeze({type:"native",body:Object.freeze([167]),lengths:Object.freeze({inputs:1,outputs:1})}),bo=Object.freeze({type:"native",body:Object.freeze([167]),lengths:Object.freeze({inputs:1,outputs:1})}),Mi=Object.freeze({type:"native",body:Object.freeze([170]),lengths:Object.freeze({inputs:1,outputs:1})}),Bi=Object.freeze({type:"native",body:Object.freeze([171]),lengths:Object.freeze({inputs:1,outputs:1})}),Ki=Object.freeze({type:"native",body:Object.freeze([168]),lengths:Object.freeze({inputs:1,outputs:1})}),Gi=Object.freeze({type:"native",body:Object.freeze([169]),lengths:Object.freeze({inputs:1,outputs:1})}),mo=Object.freeze({type:"native",body:Object.freeze([]),lengths:Object.freeze({inputs:1,outputs:1})}),Us=Object.freeze({type:"native",body:Object.freeze([193]),lengths:Object.freeze({inputs:1,outputs:1})}),ks=Object.freeze({type:"native",body:Object.freeze([192]),lengths:Object.freeze({inputs:1,outputs:1})}),Hi=Object.freeze({type:"native",body:Object.freeze([]),lengths:Object.freeze({inputs:1,outputs:1})}),Zi=Object.freeze({type:"native",body:Object.freeze([]),lengths:Object.freeze({inputs:1,outputs:1})}),Xi=Object.freeze({type:"native",body:Object.freeze([176]),lengths:Object.freeze({inputs:1,outputs:1})}),Wi=Object.freeze({type:"native",body:Object.freeze([177]),lengths:Object.freeze({inputs:1,outputs:1})}),qi=Object.freeze({type:"native",body:Object.freeze([175]),lengths:Object.freeze({inputs:1,outputs:1})}),$i=Object.freeze({type:"native",body:Object.freeze([174]),lengths:Object.freeze({inputs:1,outputs:1})}),Ji=Object.freeze({type:"native",body:Object.freeze([172]),lengths:Object.freeze({inputs:1,outputs:1})}),Qi=Object.freeze({type:"native",body:Object.freeze([196]),lengths:Object.freeze({inputs:1,outputs:1})}),ep=Object.freeze({type:"native",body:Object.freeze([173]),lengths:Object.freeze({inputs:1,outputs:1})}),tp=Object.freeze({type:"native",body:Object.freeze([196]),lengths:Object.freeze({inputs:1,outputs:1})}),To=Object.freeze({type:"native",body:Object.freeze([195]),lengths:Object.freeze({inputs:1,outputs:1})}),go=Object.freeze({type:"native",body:Object.freeze([195]),lengths:Object.freeze({inputs:1,outputs:1})}),yo=Object.freeze({type:"native",body:Object.freeze([194]),lengths:Object.freeze({inputs:1,outputs:1})}),xo=Object.freeze({type:"native",body:Object.freeze([194]),lengths:Object.freeze({inputs:1,outputs:1})}),sp=Object.freeze({type:"native",body:Object.freeze([185]),lengths:Object.freeze({inputs:1,outputs:1})}),np=Object.freeze({type:"native",body:Object.freeze([186]),lengths:Object.freeze({inputs:1,outputs:1})}),Nn=Object.freeze({type:"native",body:Object.freeze([183]),lengths:Object.freeze({inputs:1,outputs:1})}),Rn=Object.freeze({type:"native",body:Object.freeze([184]),lengths:Object.freeze({inputs:1,outputs:1})}),op=Object.freeze({type:"native",body:Object.freeze([187]),lengths:Object.freeze({inputs:1,outputs:1})}),cp=Object.freeze({type:"native",body:Object.freeze([180]),lengths:Object.freeze({inputs:1,outputs:1})}),ap=Object.freeze({type:"native",body:Object.freeze([181]),lengths:Object.freeze({inputs:1,outputs:1})}),Sn=Object.freeze({type:"native",body:Object.freeze([178]),lengths:Object.freeze({inputs:1,outputs:1})}),Pn=Object.freeze({type:"native",body:Object.freeze([179]),lengths:Object.freeze({inputs:1,outputs:1})}),rp=Object.freeze({type:"native",body:Object.freeze([182]),lengths:Object.freeze({inputs:1,outputs:1})}),Os=Object.freeze(Object.assign({"Flogram./":ho,"Flogram.*":Eo,"Flogram.+":fo,"Flogram.-":_o},{"Flogram.fp64.div":Jr,"Flogram.fp64.mul":Qr,"Flogram.fp64.add":$r,"Flogram.fp64.sub":ti,"Flogram.fp64.neg":ei,"Flogram.fp64.gt":Oi,"Flogram.fp64.lt":Ti,"Flogram.fp64.le":Ii,"Flogram.fp64.ge":Si,"Flogram.fp64.ne":ki,"Flogram.fp64.eq":Ci,"Flogram.fp64.toi32":Mi,"Flogram.fp64.tou32":Bi,"Flogram.fp64.tou64":Wi,"Flogram.fp64.toi64":Xi,"Flogram.fp64.tofp32":rp},{"Flogram.u64.add":si,"Flogram.u64.sub":ai,"Flogram.u64.mul":oi,"Flogram.u64.div":ni,"Flogram.u64.rem":fi,"Flogram.u64.gt":Ei,"Flogram.u64.lt":di,"Flogram.u64.le":xi,"Flogram.u64.ge":Ri,"Flogram.u64.ne":Ui,"Flogram.u64.eq":ji,"Flogram.u64.toi32":bo,"Flogram.u64.tou32":bo,"Flogram.u64.toi64":Hi,"Flogram.u64.tofp32":ap,"Flogram.u64.tofp64":np},{"Flogram.i64.add":ri,"Flogram.i64.sub":li,"Flogram.i64.neg":ci,"Flogram.i64.mul":pi,"Flogram.i64.div":ii,"Flogram.i64.rem":hi,"Flogram.i64.gt":_i,"Flogram.i64.lt":mi,"Flogram.i64.le":yi,"Flogram.i64.ge":Ni,"Flogram.i64.ne":Di,"Flogram.i64.eq":zi,"Flogram.i64.toi32":Oo,"Flogram.i64.tou32":Oo,"Flogram.i64.tou64":Zi,"Flogram.i64.tofp32":cp,"Flogram.i64.tofp64":sp},{"Flogram.fp32.div":ho,"Flogram.fp32.mul":Eo,"Flogram.fp32.add":fo,"Flogram.fp32.sub":_o,"Flogram.fp32.neg":ui,"Flogram.fp32.gt":bi,"Flogram.fp32.lt":gi,"Flogram.fp32.le":Ai,"Flogram.fp32.ge":Pi,"Flogram.fp32.ne":Li,"Flogram.fp32.eq":Fi,"Flogram.fp32.toi32":Ki,"Flogram.fp32.tou32":Gi,"Flogram.fp32.tou64":qi,"Flogram.fp32.toi64":$i,"Flogram.fp32.tofp64":op},{"Flogram.u32.add":pn,"Flogram.u32.sub":fn,"Flogram.u32.mul":un,"Flogram.u32.div":ln,"Flogram.u32.rem":dn,"Flogram.u32.gt":js,"Flogram.u32.lt":Cs,"Flogram.u32.le":Fs,"Flogram.u32.ge":Ds,"Flogram.u32.ne":An,"Flogram.u32.eq":Es,"Flogram.u32.toi32":mo,"Flogram.u32.toi64":ep,"Flogram.u32.tou64":tp,"Flogram.u32.tofp32":Pn,"Flogram.u32.tofp64":Rn},{"Flogram.i32.add":hn,"Flogram.i32.sub":bn,"Flogram.i32.neg":On,"Flogram.i32.mul":_n,"Flogram.i32.div":En,"Flogram.i32.rem":mn,"Flogram.i32.gt":Tn,"Flogram.i32.lt":gn,"Flogram.i32.le":yn,"Flogram.i32.ge":xn,"Flogram.i32.ne":_s,"Flogram.i32.eq":In,"Flogram.i32.toi64":Ji,"Flogram.i32.tou64":Qi,"Flogram.i32.tou32":mo,"Flogram.i32.tofp32":Sn,"Flogram.i32.tofp64":Nn},{"Flogram.i16.add":hn,"Flogram.i16.sub":bn,"Flogram.i16.neg":On,"Flogram.i16.mul":_n,"Flogram.i16.div":En,"Flogram.i16.rem":mn,"Flogram.i16.gt":Tn,"Flogram.i16.lt":gn,"Flogram.i16.le":yn,"Flogram.i16.ge":xn,"Flogram.i16.ne":_s,"Flogram.i16.eq":In,"Flogram.i16.toi32":Us,"Flogram.i16.tou32":Us,"Flogram.i16.toi64":To,"Flogram.i16.tou64":go,"Flogram.i16.tofp32":Sn,"Flogram.i16.tofp64":Nn},{"Flogram.u16.add":pn,"Flogram.u16.sub":fn,"Flogram.u16.mul":un,"Flogram.u16.div":ln,"Flogram.u16.rem":dn,"Flogram.u16.gt":js,"Flogram.u16.lt":Cs,"Flogram.u16.le":Fs,"Flogram.u16.ge":Ds,"Flogram.u16.ne":An,"Flogram.u16.eq":Es,"Flogram.u16.toi32":Us,"Flogram.u16.tou32":Us,"Flogram.u16.toi64":To,"Flogram.u16.tou64":go,"Flogram.u16.tofp32":Pn,"Flogram.u16.tofp64":Rn},{"Flogram.i8.add":hn,"Flogram.i8.sub":bn,"Flogram.i16.neg":On,"Flogram.i8.mul":_n,"Flogram.i8.div":En,"Flogram.i8.rem":mn,"Flogram.i8.gt":Tn,"Flogram.i8.lt":gn,"Flogram.i8.le":yn,"Flogram.i8.ge":xn,"Flogram.i8.ne":_s,"Flogram.i8.eq":In,"Flogram.i8.toi32":ks,"Flogram.i8.tou32":ks,"Flogram.i8.toi64":yo,"Flogram.i8.tou64":xo,"Flogram.i8.tofp32":Sn,"Flogram.i8.tofp64":Nn},{"Flogram.u8.add":pn,"Flogram.u8.sub":fn,"Flogram.u8.mul":un,"Flogram.u8.div":ln,"Flogram.u8.rem":dn,"Flogram.u8.gt":js,"Flogram.u8.lt":Cs,"Flogram.u8.le":Fs,"Flogram.u8.ge":Ds,"Flogram.u8.ne":An,"Flogram.u8.eq":Es,"Flogram.u8.toi32":ks,"Flogram.u8.tou32":ks,"Flogram.u8.toi64":yo,"Flogram.u8.tou64":xo,"Flogram.u8.tofp32":Pn,"Flogram.u8.tofp64":Rn},{"Flogram.bool.and":Yi,"Flogram.bool.or":wi,"Flogram.bool.xor":Vi,"Flogram.bool.not":vi,"Flogram.bool.eq":Es,"Flogram.bool.ne":_s},{"Flogram.char.gt":js,"Flogram.char.lt":Cs,"Flogram.char.le":Fs,"Flogram.char.ge":Ds,"Flogram.char.eq":Es,"Flogram.char.ne":_s}));var{LEB128_ENCODE:ht}=Jt,Nu=new Int8Array(1),Ru=new Uint8Array(1),ip=c=>{let s=[],r=!0;for(;r;){let h=c&127;c>>=7,c===0&&!(h&64)||c===-1&&h&64?r=!1:h|=128,s.push(h)}return new Uint8Array(s)},pp=c=>{let s=[],r=!0;for(;r;){let h=c&127;c>>=7,c===0?r=!1:h|=128,s.push(h)}return new Uint8Array(s)},lp=c=>{let s=[];for(;c>=128;)s.push(c&127|128),c>>>=7;return s.push(c),new Uint8Array(s)},up=128,fp=127,Io=64,hp=c=>{c=c<<16>>16;let s=[];for(;;){let r=c&fp;c=c>>7;let h=c===0,D=(r&Io)===0,ce=h&&D,e=c===-1,pe=(r&Io)!==0;if(ce||e&&pe){s.push(r);break}r=r|up,s.push(r)}return s};var Ep=c=>{let s=new Float32Array(1);return s[0]=parseFloat(c),new Uint8Array(s.buffer)},Ao=c=>{let s=[],r=!0;for(;r;){let h=c&127;c>>=7,c===0&&!(h&64)||c===-1&&h&64?r=!1:h|=128,s.push(h)}return new Uint8Array(s)},_p=c=>ht(c),Op=c=>{let s=new Float64Array(1);return s[0]=c,new Uint8Array(s.buffer)},bp=c=>{let s=[];for(;c>=128;)s.push(c&127|128),c>>>=7;return s.push(c),new Uint8Array(s)},dp=c=>{let s=[],r=!0;for(;r;){let h=c&127;c>>=7,c===0&&!(h&64)||c===-1&&h&64?r=!1:h|=128,s.push(h)}return new Uint8Array(s)},mp=c=>{let s=new Uint8Array(1);return s[0]=c==="TRUE"?1:c==="FALSE"?0:c,s},Tp=c=>{let s=c.charCodeAt(0);return ht(s)},No=()=>{let c=new ArrayBuffer(4);return new Float32Array(c)[0]=-0,[...new Uint8Array(c)]},gp=Object.freeze({type:"native",identity:127,opcode:65,encode:Ao,link:Object.freeze({load:Object.freeze({opcode:40,align:2,offset:0,size:4}),store:Object.freeze({opcode:54,align:2,offset:0,size:4})})}),yp=Object.freeze({type:"native",identity:127,opcode:65,none:ht(-1),encode:Tp,link:Object.freeze({load:Object.freeze({opcode:40,align:2,offset:0,size:4}),store:Object.freeze({opcode:54,align:2,offset:0,size:4})})}),xp=Object.freeze({type:"native",identity:127,opcode:65,none:ht(-1),encode:mp,link:Object.freeze({load:Object.freeze({opcode:40,align:2,offset:0,size:4}),store:Object.freeze({opcode:54,align:2,offset:0,size:4}),values:{TRUE:1,FALSE:0}})}),Ip=Object.freeze({type:"native",identity:124,opcode:68,none:No(),encode:Op,link:Object.freeze({load:Object.freeze({opcode:43,align:2,offset:0,size:8}),store:Object.freeze({opcode:57,align:2,offset:0,size:8})})}),Ap=Object.freeze({type:"native",identity:126,opcode:66,none:ht(-1),encode:bp,link:Object.freeze({load:Object.freeze({opcode:53,align:2,offset:0,size:8}),store:Object.freeze({opcode:55,align:2,offset:0,size:8})})}),Np=Object.freeze({type:"native",identity:126,opcode:66,none:ht(-9223372036854776e3),encode:dp,link:Object.freeze({load:Object.freeze({opcode:52,align:2,offset:0,size:8}),store:Object.freeze({opcode:55,align:2,offset:0,size:8})})}),Rp=Object.freeze({type:"native",identity:125,opcode:67,none:No(),encode:Ep,link:Object.freeze({load:Object.freeze({opcode:42,align:2,offset:0,size:4}),store:Object.freeze({opcode:56,align:2,offset:0,size:4})})}),Sp=Object.freeze({type:"native",identity:127,opcode:65,none:ht(-1),encode:_p,link:Object.freeze({load:Object.freeze({opcode:40,align:2,offset:0,size:4}),store:Object.freeze({opcode:54,align:2,offset:0,size:4})})}),Pp=Object.freeze({type:"native",identity:127,opcode:65,none:ht(-2147483648),encode:Ao,link:Object.freeze({load:Object.freeze({opcode:40,align:2,offset:0,size:4}),store:Object.freeze({opcode:54,align:2,offset:0,size:4})})}),zp=Object.freeze({type:"native",identity:127,opcode:65,none:ht(-32768),encode:hp,link:Object.freeze({load:Object.freeze({opcode:40,align:2,offset:0,size:4}),store:Object.freeze({opcode:54,align:2,offset:0,size:4})})}),jp=Object.freeze({type:"native",identity:127,opcode:65,encode:lp,none:ht(-1),link:Object.freeze({load:Object.freeze({opcode:40,align:2,offset:0,size:4}),store:Object.freeze({opcode:54,align:2,offset:0,size:4})})}),Cp=Object.freeze({type:"native",identity:127,opcode:65,none:ht(-128),encode:ip,decode:c=>new Int8Array([c])[0],link:Object.freeze({load:Object.freeze({opcode:40,align:0,offset:0,size:4}),store:Object.freeze({opcode:54,align:0,offset:0,size:4})})}),Fp=Object.freeze({type:"native",identity:127,opcode:65,none:ht(-1),encode:pp,link:Object.freeze({load:Object.freeze({opcode:40,align:0,offset:0,size:4}),store:Object.freeze({opcode:54,align:0,offset:0,size:4})})}),kt=Object.freeze({"Flogram.String":gp,"Flogram.Char":yp,"Flogram.Bool":xp,"Flogram.FP64":Ip,"Flogram.U64":Ap,"Flogram.I64":Np,"Flogram.FP32":Rp,"Flogram.U32":Sp,"Flogram.I32":Pp,"Flogram.I16":zp,"Flogram.U16":jp,"Flogram.I8":Cp,"Flogram.U8":Fp});var{TYPES_ASSIGN:Ro,TYPES_DRAW:Dp,TYPES_NOW:So,TYPES_ARRAY:q,TYPES_ARRAY_ASSIGNMENT:Up,TYPES_BRANCH_MATCH:Po,TYPES_BRANCH_DEFAULT:zo,TYPES_CONDITION:Ls,TYPES_LOOP:bs,TYPES_WHILE:kp,TYPES_FOREACH:Lp,TYPES_DATA:St,TYPES_COMPARE:jo,TYPES_ENUMERATION:at,TYPES_EXPRESSION:Lt,TYPES_LINK:Bt,TYPES_LOCAL:Je,TYPES_CONCAT:Co,TYPES_OBJECT:de,TYPES_RETURN:Ys,TYPES_SELECT:Pt,TYPES_MEMBER:ds,TYPES_STORE:Fo,TYPES_BREAK:Yp,TYPES_LITERAL:ve,TYPES_ARRAY_ACCESS:ws,TYPES_LINK_TO:zn,TYPES_VALUE_AT:Vs,TYPES_DROP:Do,TYPES_MAYBE:Qt,TYPES_MOVE:Uo,TYPES_NATIVE:He,TYPES_STRING:re,TYPES_FREE:wp,TYPES_FOR:Vp,TYPES_UP_TO:ko,TYPES_DOWN_TO:vp,TYPES_ALMOST_UP_TO:Lo,TYPES_ALMOST_DOWN_TO:Mp,TYPES_BRANCH:Yo,TYPES_CONTINUE:wo,TYPES_DEFAULT_BLOCK:jn,TYPES_BLOCK_END:zt,TYPES_STATEMENT:Vo,TYPES_DESTRUCTOR:vo,TYPES_SIZE:Mo,TYPES_WHILE_CONDITION:Cn,TYPES_FOREACH_CONDITION:Bo,TYPES_FOREACH_END:Ko,TYPES_FP32:Go,TYPES_I32:mt,TYPES_I64:Bp,TYPES_FP64:Kp,TYPES_CHAR:Fn,TYPES_BOOL:Dn,TYPES_BLOCK_BEGIN:Ho,TYPES_WHEN:Gp,TYPES_FUNCTION_CALL:Zo,TYPES_PROCEDURE:Hp,TYPES_CONSTRUCTOR:Zp,TYPES_UNREACHABLE:Xp}=Ns,{K_ASSIGNMENT:es,K_FLOGRAM:Qe}=Rt.Keywords,{ENUM_MEMORY_SIZE:Lu,ENUM_STACK_SIZE:Un,ARRAY_MEMORY_SIZE:ms,ARRAY_STACK_SIZE:Et,ARRAY_DEFAULT_CAPACITY:Wp,STRING_MEMORY_SIZE:kn,STRING_STACK_SIZE:Kt,OBJECT_MEMORY_SIZE:vs,OBJECT_STACK_SIZE:ts,NATIVE_MEMORY_SIZE:At,NATIVE_STACK_SIZE:Ts,NATIVE_SIZE:Yu,STEP:Tt,DOUBLE_STEP:_t,TRIPPLE_STEP:wu}=Rt.Sizes,jt=2,Gt=3,ss=12,ns=13,et=16,_e=26,i=65,Xo=71,qp=113,$p=114,gs=70,Wo=76,tt=32,Ct=33,F=35,le=36,Jp=15,Ht=11,qo=4,Qp=5,Xe=64,pt=127,Me=108,el=109,H=106,tl=107,Be=54,st=40,sl=0,ue=0,fe=2,Yt=4,nl="alloc",Ln="dealloc",$o="merge",Jo="save",ol="undo",cl="undoPenultimate",al="draw",rl="drawI64",il="drawFP32",pl="drawFP64",ll="now",g=0,Le=1,Qo="Flogram.draw",ul="Flogram.now",ys=new Set(["==","!=",">",">=","<","<=","or","and","or","not"]),fl=new Set(["I32","U32","Bool","FP32","I64","U64","FP64"]),{LEB128_ENCODE:l}=Jt,{INT_ARRAY_START:hl,FLOAT_ARRAY_START:El,STRING_START:ec,CHAR_START:_l,END_OF_LINE:Ol,NAT_ON_HORIZON:bl,BIG_NAT_ON_HORIZON:dl,FLOAT_ON_HORIZON:ml,BIG_FLOAT_ON_HORIZON:Tl}=Rt.DrawStates,Yn,N=(c,s)=>`${s}.${c}`,tc=(c,s,r)=>{let h=r.get(c);if(h&&h.length===1)return h[0];if(h&&h.length>1)return h[0];throw console.log(c),console.log(s),Error("No Callees were found")};function Ms(c,s,r,h,D){c?.description?.inputs.length>0?Yn=c.description.inputs[0].data.name:c?.description?.outputs.length>0&&(Yn=c.description.outputs[0].data.name);let ce=t=>{Ie(t.collection).length},e=[],pe=new Set,me=!1,Oe=t=>{pe.add(t)},$=()=>{e.push(et,nl),Oe("alloc")},Re=t=>{t===Go?(e.push(et,il),Oe("drawFP32")):t===Kp?(e.push(et,pl),Oe("drawFP64")):t?.includes("64")?(e.push(et,rl),Oe("drawI64")):(e.push(et,al),Oe("draw"))},lt=()=>{Oe("now"),e.push(et,ll)},ut=(t=g)=>{e.push(i,0),$(),e.push(le,t)},Ye=()=>{e.push(F,g),e.push(F,Le),e.push(et,Jo),e.push(F,Le),e.push(F,g),e.push(et,Jo),Oe("save")},nt=()=>{e.push(et,ol),e.push(le,Le),e.push(le,g),Oe("undo")},dt=()=>{e.push(et,cl),e.push(le,Le),e.push(le,g),Oe("undoPenultimate")},ft=()=>{e.push(et,$o),Oe("merge")},yt=(t,n=!1)=>{let o=t.path===Qe&&t.name!==re&&t.layout!==q&&t.type!==q;return n?o&&t.mutable:o},{description:Zs}=c,{inputs:Xs,locals:Vt,statements:xs}=Zs,Ce=new Map,Fe=new Map,Dt=new Map;{let t=0,n=o=>{for(let p of o){let{name:_,data:b}=p;switch(Ce.set(_,t),Fe.set(_,p),b.type){case Qt:case St:{let{name:R,path:j}=b,U=N(R,j);switch(R){case re:{t=t+Kt|0;break}default:{let x=s.get(U);if(!x)throw new Error("Key not found: ",U);switch(x.type){case He:{t=t+Ts|0;break}case at:{t=t+Un|0;break}case de:{let{length:ee}=x;t=t+ts|0;break}}break}}break}case q:{t=t+Et|0;break}case Bt:{let R=s.get(N(b.name,b.path));b.name===re?t=t+Kt|0:b.name===q||b.layout===q?t=t+Et|0:R.type===de?t=t+ts|0:t=t+Ts|0;break}}}};n(Xs),n(Vt)}let ge=0,Ke=[];for(let t of Vt){let{data:n}=t,o=()=>{Ke.push(1,pt),ge=ge+1|0},p=()=>{Ke.push(1,pt),ge=ge+1|0,Ke.push(1,pt),ge=ge+1|0,Ke.push(1,pt),ge=ge+1|0},_=()=>{Ke.push(1,pt),ge=ge+1|0,Ke.push(1,pt),ge=ge+1|0},b=()=>{Ke.push(1,pt),ge=ge+1|0,Ke.push(1,pt),ge=ge+1|0},R=U=>{let{identity:x}=U;Ke.push(1,x),ge=ge+1|0},j=()=>{Ke.push(1,pt),ge=ge+1|0,Ke.push(1,pt),ge=ge+1|0,Ke.push(1,pt),ge=ge+1|0};if(yt(n,!0)){o();continue}switch(n.type){case q:{p();break}case Bt:{let U=s.get(N(n.name,n.path));n.name===q?p():n.name===re?_():U&&U.type===de?b():o();break}case Qt:case St:{let{name:U,path:x}=n;switch(U){case re:{p();break}default:{let ee=N(U,x),ie=s.get(ee);switch(ie.type){case He:{R(ie);break}case at:{j();break}case de:{b();break}}break}}break}}}((t,n)=>{for(let[o,p]of t)if(p.type==n){Ke.push(1,pt),ge=ge+1|0;break}})(s,de);let Ws=l(ge);e.push(...Ws,...Ke);let qe=t=>{if(typeof t!==de)return t;switch(t.type){case Je:return t.name;case zn:return qe(t.value);case Vs:return qe(t.link);case ds:return`${t.type}_${t.trail.join("_")}`;case ws:return t.array.name;case Pt:return qe(t.value);case Fo:return qe(t.link)}return null},Ie=t=>{if(!t)return null;switch(t.type){case ve:return t;case Je:return Fe.get(t.name)?.data;case Vs:return Ie(t.link);case zn:return Ie(t.value);case Uo:return Ie(t.value);case Qt:return t;case Mo:{if(t.value.type===Je)return{name:mt,path:Qe,type:St};break}case ws:{let n=Ie(t.array);if(n.name===re)return{name:n.type===q?re:Fn,path:Qe,type:St};let o=Fe.get(qe(t));return o.details||o.data.details||{...o.data,type:o.data.name===q?q:St}}case Pt:{let{value:n,trail:o}=t,{name:p}=n,_=Fe.get(p||qe(n)),{data:b}=_,R=N(b.name,b.path),j=s.get(R);if(j.type===at){let{labels:ie}=j,je=ie.find(T=>T.props.includes(o[0]));if(!je){console.error("Get Type: Unknown enum label value.....");return}let k=s.get(N(je.name,R)).members.get(o[0]);if(o.length>1)for(;o.length>0;){let T=o.shift();k=s.get(N(k.name,k.path)).members.get(T)}return k}let{indivisibles:U}=j,x=JSON.parse(JSON.stringify(o)),ee=j;for(;x.length>0;){let ie=x.shift();if(x.length>0){let je=ee.members.get(ie),Ze=N(je.name,je.path);ee=s.get(Ze);continue}ee=ee.members.get(ie)}return ee}case Lt:{let n=h.find(R=>R.name===t.name&&R.path===t.path);if(n)return n.description.outputs[0].data;let o=[...c.description.locals,...c.description.inputs],p=R=>h.find(j=>j.type===Hp&&j.name===R.name)?.description.outputs[0],_=(R,j)=>{let U;for(let x=0;x<R.name.length-1;x++)j=Fe.get(R.name[0]);if(j){let x=N(j.data.name,j.data.path),ee=h.find(ie=>ie.name===R.name[R.name.length-1]&&ie.path===x);if(ee)return ee.description.outputs[0];console.error("Unable to find shape: ",j,x)}return U?.description.members?.find(x=>x.name===R.name[R.name.length-1])?.description.outputs[0]},b;if(t.path!==Qe){if(b=p(t),typeof t.name=="object"){let R=o.find(U=>U.name===t.name[0]).data;b=_(t,R);let j=t.name.length;t.name[j-1]===Zp&&(b={data:R})}return b&&b.data}else{if(t.name===So)return{type:St,name:Bp,path:Qe};if(ys.has(t.name))return{type:St,name:Dn,path:Qe};{let R=t.inputs.map(U=>Ie(U)),j=h.find(U=>U.description&&Array.isArray(U.description.inputs)?U.description.inputs.length!==R.length||U.name!==t.name||U.path!==t.path?!1:U.description.inputs.every((x,ee)=>x.data.name===R[ee].name):!1);if(j){let{description:U}=j,{outputs:x}=U;return x[0].data}else{console.error("Not found:: ",t);return}}}break}}},Wn=t=>{Ie(t)?.mutable&&e.push(st,fe,ue)},I=(t,n=Ys)=>{let o=0,p=[],_=(k,T)=>{let K={type:"call",key:k,inputs:T};p.unshift(K)},b=k=>{let T={type:"value",value:k};p.unshift(T)},R=k=>{let T={type:ds,member:k};p.unshift(T)},j=(k,T,K,B,G)=>{let Z={key:null,stop:!1},M;if(k&&fs.includes(k.name))if(k.name===re)e.push(i,Math.floor(Math.random()*2)),e.push(i,Math.floor(Math.random()*2)),e.push(Xo),Z.stop=!0;else{let{name:X}=k;M=N(X.toLowerCase()+"."+ct(B),K),Yn=X}else if(k){let{name:X,path:Q}=k,Ue=N(X,Q),O=s.get(Ue);if(O.type===at){let{labels:a}=O,z=Ie(T);if(N(z.name,z.path)===Ue){let E=a.find(S=>S.props.includes(T.trail[0])),f=s.get(N(E.name,Ue)).indivisibles.mapTrail.get(T.trail[0]);M=N(f.data.name.toLowerCase()+"."+ct(B),K)}else M=N(z.name.toLowerCase()+"."+ct(B),K)}else{let{indivisibles:a}=O,{mapTrail:z}=a,E=G.every(f=>{let S=Ie(f),m=N(S.name,S.path);return s.get(m).type===de}),C=Ie(T);if((B=="=="||B=="!=")&&E){let f=z.size-1;for(let[S,m]of z){p.unshift({type:jo,currentIndex:f,name:B}),M=N(m.data.name.toLowerCase()+"."+ct(B),m.data.path);let L=G.map(v=>({type:Pt,value:{type:Je,name:v.name||qe(v)},trail:[m.trail]}));_(M,L);var Ne=L.length-1|0;for(let v=Ne;v>=0;v=v-1|0){let ne=L[v];b(ne)}f--}Z.stop=!0}else G.every(f=>Ie(f).name===re)?Z.stop=!0:M=N(C.name.toLowerCase()+"."+ct(B),K)}}return Z.key=M,Z},U=k=>{let{name:T,path:K,inputs:B}=k;if(ys.has(k.name))return Dn;if(fl.has(k.name))return k.name;let G=h.filter(M=>M.name===T&&M.path===K&&M.description.inputs.filter(Ne=>Ne.name.startsWith("member_")?!Ne.data.type===Bt&&!K.includes("."):!0).length===B.length);if(G.length===1)return G[0].description.outputs[0]?.data.name??"";if(B.find(M=>M.type==Lt)){let M=B.map(X=>{if(X.type===Je)return Fe.get(X.name);if(X.type===ve)return{data:X};if(X.type===Lt)return{data:{name:U(X)}}}),Ne=h.find(X=>X.description&&Array.isArray(X.description.inputs)?X.description.inputs.length!==M.length?!1:X.description.inputs.every((Q,Ue)=>Q.data.name===M[Ue].data.name):!1);return Ne?ys.has(Ne.name)?Ne.description.inputs[0].data.name:Ne.description.outputs[0].data.name:"unknown"}else{let M=B.map(X=>({data:Ie(X)})),Ne=h.find(X=>X.description&&Array.isArray(X.description.inputs)?X.description.inputs.length!==M.length?!1:X.description.inputs.every((Q,Ue)=>Q.data.name===M[Ue].data.name):!1);if(Ne)return ys.has(Ne.name)?Ne.description.inputs[0].data.name:Ne.description.outputs[0].data.name;throw console.log(k),new Error("could not find the type for procedure: ",k.name)}},x=k=>{let{inputs:T,name:K,path:B}=k,G=N(K,B),Z=[B],M;if(typeof K===de){let X=K[0];if(M=Fe.get(X),M){Z.push(M.data.name);for(let Ue=1;Ue<=K.length-2;Ue++)X=K[Ue],M=Fe.get(X),M&&Z.push(M.data.name)}let Q=K.length-1|0;G=N(K[Q],Z.join("."))}if(B==="Flogram"&&K!==Dp&&K!==So){let X=T.find(a=>a.type===Lt),Q=T.find(a=>a.type===ve),Ue,O;for(let a of T){let z=Ie(a);if(z){Ue=z,O=a;break}}if(Ue){let a=j(Ue,O,B,K,T);if(G=a.key,a.stop)return}else if(Q)G=N(`${Q.name.toLowerCase()}.${ct(K)}`,B);else if(X)G=N(`${U(X).toLowerCase()}.${ct(K)}`,B);else{let a=h.find(E=>E.name===k.name&&E.path===k.path&&E.description.inputs.length===k.inputs.length),z=h.filter(E=>E.name===k.name&&E.path===k.path&&E.description.inputs.length===k.inputs.length);G=N(`${ys.has(a.name)?a.description.inputs[0]?.data.name.toLowerCase():a.description.outputs[0]?.data.name.toLowerCase()}.${ct(a.name)}`,B)}}if(_(G,T),typeof K===de){let X=tc(G,T,r);if(X){let{procedure:Q}=X,{description:Ue}=Q,{self:O}=Ue,a=Fe.get(K[0]),z=N(a.data.name,a.data.path),E=s.get(z);if(E){let C=Ce.get(K[0]),{indivisibles:f,members:S}=E,{mapTrail:m}=f;for(let L=O.length-1|0;L>=0;L--){let v=O[L];if(v.type===ds){let ne=v.trail.join(".");if(m.get(ne)){let{data:Pe,address:oe}=m.get(ne),Ve=N(Pe.name,Pe.path),ae={isObject:s.get(Ve).type===de,index:C,address:oe};R(ae)}else throw Error("TODO: Using objects of depth greater than one.")}else b(t)}}}}if(G!==Qo){var Ne=T.length-1|0;for(let X=Ne;X>=0;X=X-1|0){let Q=T[X];b(Q)}}},ee=k=>{let{key:T,inputs:K}=k;if(T===Qo){for(let Z of K){let M=Ie(Z);Z.type===Pt?M?.name===re?(e.push(i,...l(ec)),Re(),I(Z),e.push(le,g),e.push(st,fe,ue),Re(),e.push(F,g),e.push(st,fe,ue),Re()):(I(Z),Re(M?.name)):M?.name===re||Z.type===Co?(e.push(i,...l(ec)),Re(),I(Z),Re(),Re()):M?.type===q||M?.name===q||M?.layout===q?(Rs.includes(M.name)?e.push(i,...l(El)):e.push(i,...l(hl)),Re(),I(Z),e.push(_e),Re(),Re()):M?.name===Fn?(e.push(i,...l(_l)),Re(),I(Z),Re()):s.get(N(M.name,M.path))?.type===at?(I(Z),e.push(_e,_e),Re()):(I(Z),Re(M?.name))}e.push(i,...l(Ol)),Re(),o=o-K.length|0;return}if(T===ul){lt();return}let B=tc(T,K,r);switch(B.type){case He:{let{body:Z}=B;e.push(...Z);break}case"artificial":{let{index:Z}=B;e.push(et,Z);break}}let{lengths:G}=B;o=o-G.inputs|0,o=o+G.outputs|0},ie=k=>{let{value:T}=k,K=O=>{let a=0;me=!0;let z=qe(O),E,C;if(O.type===Pt){let{value:f,trail:S}=JSON.parse(JSON.stringify(O)),{name:m}=f,L=Fe.get(m),{data:v}=L,ne=N(v.name,v.path),Pe=s.get(ne),{indivisibles:oe}=Pe,{mapTrail:Ve}=oe,ae=S.join("."),be=JSON.parse(JSON.stringify(S)),Te=Pe;for(;be.length>0;){let xt=be.shift();if(be.length>0){let ot=Te.members.get(xt),$e=N(ot.name,ot.path);Te=s.get($e);continue}Te=Te.members.get(xt)}let ke=N(Te.name,Te.path);E=s.get(ke)}else{let f=Fe.get(z),{data:S}=f,{name:m,path:L,segment:v}=S,ne=N(m,L);E=s.get(ne),C=m===re}if(E){switch(E.type){case He:{ie({value:O});let{link:f}=E,{load:S}=f;C||e.push(S.opcode,S.align,S.offset),a=a+1|0;break}case de:{let f=0,S=ne=>{ie({value:O});let{link:Pe}=ne,{load:oe}=Pe;e.push(oe.opcode,oe.align,oe.offset+f|0),a=a+1|0,f=f+oe.size|0},m=()=>{},{indivisibles:L}=E,{mapTrail:v}=L;for(let ne of v.values()){if(ne.type===Bt){m();continue}let{data:Pe}=ne,{name:oe,path:Ve}=Pe,ae=N(oe,Ve),be=s.get(ae);switch(be.type){case He:{S(be);break}case at:{ie({value:O}),e.push(st,fe,ue+f),a=a+1|0,f=f+Yt|0,ie({value:O}),e.push(i,...l(Tt)),e.push(st,fe,ue+f),e.push(H),a=a+1|0,f=f+Yt|0,ie({value:O}),e.push(i,...l(_t)),e.push(st,fe,ue+f),e.push(H),a=a+1|0,f=f+Yt|0;break}}}break}}return a}},B=(O,a=!0,z=!0)=>{let E=0;me=!0;function C(f){let{literal:S,name:m,path:L,vSize:v}=f,ne=v||S.length;f.quantity.capacity&&!v&&f.quantity.capacity.type===ve&&(ne=parseInt(f.quantity.capacity.literal,10));let Pe=N(m,L),oe=s.get(Pe),Ve=oe.type===de||m===re&&f.layout===q||f.contains===q;if(!f.quantity.capacity)if(f.literal)f.quantity.capacity={type:ve,name:mt,path:Qe,literal:`${Math.max(f.literal?.length||0,Wp)}`};else throw Error("Value without length provided for array container.");if(Ve)I(f.quantity.capacity),m===re&&f.layout===q?e.push(i,...l(kn)):f.contains===q?e.push(i,...l(ms)):oe.type===de&&e.push(i,...l(vs)),e.push(Me),$(),e.push(le,g),Ye();else{Ye(),I(f.quantity.capacity);let ae=N(f.name,f.path),be=s.get(ae),{store:Te}=be.link;e.push(i,...l(Te.size)),e.push(Me),$(),e.push(le,g)}for(let ae=0;ae<ne;ae++){let be=S[ae];if(be)if(be.name===re&&f.layout===q||be.layout===q&&oe.type!==de){let Te=[];if(be.layout===q)e.push(F,g),e.push(F,g),e.push(F,g),e.push(F,g),e.push(i,...l(ae)),e.push(i,...l(ms)),e.push(Me),e.push(H),Te.push(be.literal),C(be),e.push(F,g),e.push(Be,fe,ue),e.push(i,...l(Tt)),e.push(i,...l(ae)),e.push(i,...l(_t)),e.push(Me),e.push(H),e.push(H),I(be.quantity.size),e.push(Be,fe,ue),e.push(i,...l(_t)),e.push(i,...l(ae)),e.push(i,...l(_t)),e.push(Me),e.push(H),e.push(H),I(be.quantity.size),e.push(Be,fe,ue),e.push(le,g);else{let ke=be.size||be.literal.length;for(let ot=0;ot<ke;ot++)Te.push({type:be.type,path:be.path,name:"I32",literal:be.literal[ot].charCodeAt().toString()});let xt={type:ve,name:mt,layout:q,path:be.path,literal:Te,quantity:{size:{literal:Te.length.toString(),type:ve,name:mt,path:Qe},capacity:{literal:Te.length.toString(),type:ve,name:mt,path:Qe}}};e.push(F,g),e.push(F,g),e.push(F,g),e.push(i,...l(ae)),e.push(i,...l(vs)),e.push(Me),e.push(H),C(xt),e.push(F,g),e.push(Be,fe,ue),e.push(i,...l(Tt)),e.push(i,...l(ae)),e.push(i,...l(_t)),e.push(Me),e.push(H),e.push(H),e.push(i,...l(ke)),e.push(Be,fe,ue),e.push(le,g)}}else switch(oe.type){case He:{let{link:Te}=oe,{store:ke}=Te;e.push(F,g),e.push(i,...l(At)),e.push(i,...l(ae)),e.push(Me),e.push(H),!be||be.type===ve?e.push(oe.opcode,...oe.encode(be?.literal||0)):I(be),e.push(ke.opcode,ke.align,ke.offset),ft(),E=3;break}case de:{e.push(F,g),e.push(F,g),e.push(i,...l(ae)),e.push(i,...l(8)),e.push(Me),e.push(H),I(be),e.push(le,Le),e.push(Be,fe,ue),e.push(le,g),e.push(F,g),e.push(i,...l(Tt)),e.push(i,...l(ae)),e.push(i,...l(_t)),e.push(Me),e.push(H),e.push(H),e.push(F,Le),e.push(Be,fe,ue);break}}}}return C(O),a&&(e.push(F,g),E=1),z&&(I(O.quantity.size),I(O.quantity.capacity),E=2),E},G=(O,a,z=!0)=>{let E=s.get(a);ut();let C=(m,L,v=null,ne=!1)=>{if(Ye(),dt(),e.push(F,g),e.push(F,g),e.push(F,g),ne&&e.push(F,g),nt(),e.push(i,...l(L)),e.push(H),e.push(F,g),e.push(Be,fe,ue),e.push(i,...l(L)),e.push(i,...l(Tt)),e.push(H),e.push(H),v!=null)Q(v,v+1|0);else if(m)I(ne?m.size:m);else throw new Error("Unable to read object length");if(e.push(Be,fe,ue),ne){if(e.push(i,...l(L)),e.push(i,...l(_t)),e.push(H),e.push(H),v!=null)Q(v+1,v+2|0);else if(m)I(m.capacity);else throw new Error("Unable to read object length");e.push(Be,fe,ue)}e.push(le,g)},f=[];for(let[m,L]of E.members){if(!L)continue;let v=O.find(oe=>oe.name===m)||{name:m,value:L.value},ne=N(L.name,L.path),Pe=s.get(ne);if(L.type===q){e.push(i,...l(ms)),$(),e.push(_e),f.push({data:{keyName:m,keyData:L},literal:v});continue}switch(Pe.type){case He:{let{link:oe}=Pe,{store:Ve}=oe;if(L.type===Bt)Ye(),e.push(i,...l(At)),$(),I(v.value),e.push(Ve.opcode,Ve.align,Ve.offset),nt();else if(L.name===re)e.push(i,...l(_t)),$(),e.push(_e),f.push({data:{keyName:m,keyData:L},literal:v});else{e.push(i,...l(Ve.size)),$();let ae=JSON.parse(JSON.stringify(v.value));ae.literal&&(ae.name!==L.name||ae.path!==L.path)&&(ae={...ae,name:L.name,path:L.path}),I(ae),e.push(Ve.opcode,Ve.align,Ve.offset)}ft();break}case de:{e.push(i,...l(_t)),$(),e.push(_e),f.push({data:{keyName:m,keyData:L},literal:v});break}}}if(f.length>0){let m=f[0],{data:L,literal:v}=m,{keyName:ne,keyData:Pe}=L,{type:oe,name:Ve,layout:ae,path:be}=Pe,ke=($e=>{let It=E.indivisibles.mapTrail;if(It.has($e))return It.get($e).address;let Mt=Array.from(It.entries()).filter(([en])=>en.startsWith(`${$e}.`));return Mt.length?(Mt.sort((en,Ec)=>en[1].address-Ec[1].address),Mt[0][1].address-8):null})(ne),xt=N(Ve,be),ot=s.get(xt);if(Ve===re){Ye(),I(v.value),e.push(_e),e.push(le,g);let $e={type:ve,name:mt,literal:v.value.size||v.value.literal.length,path:Qe};C($e,ke),ft()}else if(ot.type===de){Ye();let $e=G(v.value.literal,xt,!1);C({type:ve,name:mt,literal:$e,path:Qe},ke),ft()}else if(oe===q||ae===q)if(v.value.type===Je){let $e=Ce.get(v.value.name);Ye(),M(Pe,$e),C(Pe.quantity,ke,$e+1,!0),ft()}else Ye(),B(v.value,!1,!1),C(v.value.quantity,ke,null,!0),ft();else throw Error("Error: Unable to identify type: ",ot.type)}let S=E.indivisibles.mapTrail.size+f.length;return z&&(e.push(F,g),e.push(i,...l(S))),S},Z=(O,a)=>{let z=0;me=!0;let E=Fe.get(a),C;if(E){let{data:S}=E,{name:m,path:L,segment:v}=S;C=N(m,L)}else{let S=Ie(O);C=N(S?.name,S?.path)}let f=s.get(C);switch(f.type){case He:{let{link:S}=f,{store:m}=S;e.push(i,...l(m.size)),$(),e.push(le,g),e.push(F,g),I(O),e.push(m.opcode,m.align,m.offset),e.push(F,g),z=z+7|0;break}case de:{let S=0,{indivisibles:m}=f,{mapTrail:L}=m,v=O.trail.join(".");switch(O.type){case Pt:{let ne=L.get(v);if(ne&&yt(ne.data)){let Pe=N(ne.data.name,ne.data.path),oe=s.get(Pe),{link:Ve}=oe,{store:ae}=Ve;e.push(i,...l(ae.size)),$(),e.push(le,g),e.push(F,g),I(O),e.push(ae.opcode,ae.align,ae.offset),e.push(F,g);break}}default:{I(O);break}}break}}return z},M=(O,a=0,z=2)=>{let{name:E,path:C}=O,f=N(E,"Flogram"),S=s.get(f),{link:m}=S,{store:L,load:v}=m,ne=a;return ut(),e.push(i,0),e.push(le,Le),e.push(jt,Xe),e.push(Gt,Xe),Q(ne+z,ne+z+1|0),e.push(F,Le),e.push(Wo),e.push(ns,1),e.push(i,...l(L.size)),$(),Q(ne,ne+1|0),e.push(F,Le),e.push(i,v.size),e.push(Me),e.push(H),e.push(v.opcode,v.align,v.offset),e.push(L.opcode,L.align,L.offset),ft(),e.push(F,Le),e.push(i,1),e.push(H),e.push(le,Le),e.push(ss,0),e.push(Ht),e.push(Ht),O.length},Ne=(O,a=2)=>{let{name:z,path:E}=O,C=N(z,"Flogram"),f=s.get(C),{link:S}=f,{store:m,load:L}=S;return ut(),Ye(),dt(),e.push(i,0),e.push(le,Le),e.push(jt,Xe),e.push(Gt,Xe),e.push(F,g),e.push(i,...l(At*a)),e.push(H),e.push(st,fe,ue),e.push(F,Le),e.push(Wo),e.push(ns,1),e.push(i,...l(m.size)),$(),e.push(F,g),e.push(st,fe,ue),e.push(F,Le),e.push(i,L.size),e.push(Me),e.push(H),e.push(L.opcode,L.align,L.offset),e.push(m.opcode,m.align,m.offset),ft(),e.push(F,Le),e.push(i,1),e.push(H),e.push(le,Le),e.push(ss,0),e.push(Ht),e.push(Ht),nt(),O.length},X=(O,a)=>{let z=s.get(a);if(!z)throw new Error("No shape found");let{opcode:E}=z,C=z.encode(O);e.push(E,...C)},Q=(O,a)=>{for(;O<a;)e.push(tt,O),O=O+1|0};if(!T)throw new Error("Invalid value provided to actionValue");switch(T.type){case Lt:{x(T);break}case"instance":{let{path:O,members:a}=T;var Ue=a.length-1|0;for(let z=Ue;z>=0;z=z-1|0){let E=a[z],{path:C,value:f}=E;b(f)}break}case Qt:{let{data:O}=T,{name:a,path:z}=O,E=N(a,z),C=s.get(E);T.layout==="NONE"?e.push(C.opcode,...C.none):I(T.value),o=o+1|0;break}case Vs:{let{link:O}=T;D.optimization;let a=K(O);o=o+a|0;break}case zn:{let{value:O}=T,a=qe(O);if(Fe.get(a)?.data.type===q){I({name:a,type:Je});return}if(Ie(O)?.name===re){I(O);return}let E=Z(O,a);o=o+E|0;break}case Mo:{let{value:O}=T;switch(O.type){case Je:{if(Dt.get(O.name)&&D.linkValueLoad){let a=Dt.get(O.name),z=a.source.length;typeof a.source.literal===re.toLowerCase()&&(z=literal.value.literal.length),e.push(i,...l(z))}else{let a=Ce.get(O.name);Q(a+1|0,a+2|0)}break}}break}case Co:{let{values:O}=T;ut(Le),Ye(),Ye();for(let a of O){let z=Ie(a),E=N(z.name,z.path),C=s.get(E);if(z.name===re)I(a,es),e.push(_e),e.push(_e);else if(z.type===q||z.layout===q)I(a,es),e.push(_e),e.push(_e),e.push(_e);else if(C?.type===at)console.log(Ie(a));else if(ls.includes(z.name)){let{link:f}=C,{store:S,load:m}=f;e.push(i,...l(Yt)),$(),e.push(i,...l(sn.includes(z.name)?dl:bl)),e.push(Be,fe,ue),e.push(i,...l(S.size)),$(),I(a),z.mutable&&e.push(m.opcode,m.align,m.offset),e.push(S.opcode,S.align,S.offset)}else if(Rs.includes(z.name)){let{link:f}=C,{store:S,load:m}=f;e.push(i,...l(Yt)),$(),e.push(i,...l(z.name===Go?ml:Tl)),e.push(Be,fe,ue),e.push(i,...l(S.size)),$(),I(a),z.mutable&&e.push(m.opcode,m.align,m.offset),e.push(S.opcode,S.align,S.offset)}else if(z.name===Fn){let{link:f}=C,{store:S,load:m}=f;e.push(i,...l(S.size)),$(),I(a),z.mutable&&e.push(m.opcode,m.align,m.offset),e.push(S.opcode,S.align,S.offset)}else{let{link:f}=C,{store:S,load:m}=f;e.push(i,...l(S.size)),$(),I(a),z.mutable&&e.push(m.opcode,m.align,m.offset),e.push(S.opcode,S.align,S.offset)}ft()}nt(),nt(),ut(),e.push(F,Le),e.push(F,g),e.push(F,Le),e.push(tl),e.push(i,...l(At)),e.push(el),o=o+2|0;break}case ve:{let{literal:O,name:a,path:z}=T,E=N(a,z),C=s.get(E);if(T.layout===q){B(T),o=o+3|0;return}else if(a===re){let f=[];for(let m of O)f.push({type:ve,literal:m.charCodeAt(0).toString(),name:mt,path:"Flogram"});let S={...T,name:mt,layout:q,contains:null,quantity:{capacity:{literal:f.length.toString(),type:ve,name:mt,path:Qe},size:{literal:f.length.toString(),type:ve,name:mt,path:Qe}},literal:f};B(S),e.push(_e),o=o+2|0;return}if(C)if(C.type===de)G(O,E),o=o+2|0;else if(C.type===at){if(X(O,E),o=o+3|0,T.props?.length>0){let f=N(a,z),S=N(O,f),L=s.get(S).indivisibles.mapIndex,v=Object.freeze({type:ve,name:O,literal:T.props.map(ne=>({name:L.get(T.props.indexOf(ne)).trail,value:ne})),path:f});G(v.literal,S)}else e.push(i,0),e.push(i,0);return}else X(O,E),o=o+1|0;else throw console.log(E),new Error("NO SHAPE FOUND!!!!!!!!!",T);break}case ws:{let{array:O,index:a}=T,z=qe(O),E=Ce.get(z),C=Ie(O);E!=null;let f=()=>{I(O),e.push(_e),e.push(_e)},S=N(C.name,C.path);me=!0;let m=s.get(S);switch(m.type){case He:if(C.contains===q||C?.type===q&&C?.layout===q||C?.name===re&&C.contains)E!=null?Q(E,E+1|0):f(),I(a),e.push(i,...l(At)),e.push(Me),e.push(H),e.push(le,g),Ye(),Ne(C);else if(C.name===re&&C.type===q)E!=null?Q(E,E+1|0):f(),I(a),e.push(i,...l(At)),e.push(Me),e.push(H),e.push(le,g),Ye(),Ne(C,2);else{let{link:L}=m,{load:v}=L;E!=null?Q(E,E+1|0):f(),I(a),e.push(i,...l(v.size)),e.push(Me),e.push(H),e.push(v.opcode,v.align,v.offset),o=o+1|0;break}case de:{E?Q(E,E+1|0):f(),I(a),C?.type===q?C?.name!==re&&!C?.contains?e.push(i,...l(At)):C.name===re?e.push(i,...l(kn)):e.push(i,...l(ms)):e.push(i,...l(vs)),e.push(Me),e.push(H),e.push(st,fe,ue),Q(E,E+1|0),e.push(i,...l(At)),I(a),C?.type===q?C?.name!==re&&!C?.contains?e.push(i,...l(At)):C.name===re?e.push(i,...l(kn)):e.push(i,...l(ms)):e.push(i,...l(vs)),e.push(Me),e.push(H),e.push(H),e.push(st,fe,ue),o=o+2|0;break}}break}case Uo:{I(T.value);break}case Je:{let{name:O}=T,a=Ce.get(O),z=Fe.get(O);if(D.optimization){let f=Dt.get(z.name);if(f){let S=m=>m.name===Dn?m.literal==="FALSE"||m.literal=="0"?0:1:parseInt(f.source.literal,10);if(f.source.name!==re&&f.source.layout!==q){let m=S(f.source);e.push(i,...l(m));return}}}let{data:E}=z,C=s.get(N(E.name,E.path));switch(E.type){case Bt:{E.name===q?(Q(a,a+Et|0),o=o+Et|0):C.type===de?(Q(a,a+ts|0),o=o+ts|0):E.name===re?(Q(a,a+Kt|0),o=o+Kt|0):(Q(a,a+Ts|0),o=o+Ts|0);break}case q:{n===es&&E.quantity.capacity?(M(E,a),e.push(F,g),E.quantity.capacity?(I(E.quantity.size),I(E.quantity.capacity)):Q(a+1,a+Et|0)):(Q(a,a+Et|0),o=o+Et|0);break}case Qt:case St:{let{name:f,path:S}=E,m=N(f,S),L=s.get(m);switch(E.layout){case q:{Q(a,a+Et|0),o=o+Et|0;break}default:{switch(L.type){case He:{if(f===re){n===es?(ut(),Ye(),Oe("save"),e.push(i,0),e.push(le,g),e.push(jt,Xe),e.push(Gt,Xe),e.push(i,Yt),$(),e.push(tt,a),e.push(F,g),e.push(i,...l(At)),e.push(Me),e.push(H),e.push(st,fe,ue),e.push(Be,fe,ue),e.push(F,g),e.push(i,1),e.push(H),e.push(le,g),e.push(et,$o),Oe("merge"),e.push(F,g),e.push(tt,a+1),e.push(gs),e.push(ns,1),e.push(ss,0),e.push(Ht),e.push(Ht),nt(),Oe("undo"),e.push(F,g),e.push(tt,a+1)):(Q(a,a+2|0),o=o+2|0);break}else Q(a,a+1|0);break}case at:{Q(a,a+Un|0),o=o+Un|0;break}case de:{Q(a,a+ts|0),o=o+ts|0;break}}break}}break}}break}case Pt:{let{value:O,trail:a}=T,z=O.name||O.link||O.value;me=!0;let E=Fe.get(z),C;if(E){let{data:Te}=E;C=N(Te.name,Te.path)}else{let Te=Ie(O);C=N(Te.data?.name,Te.data?.path)}let f=s.get(C);if(f.type===at){let{opcode:Te}=f;Ye(),I(O),e.push(_e),e.push(le,g);let ke=f.labels.find(Mt=>Mt.props.includes(a[0]));if(e.push(_e),e.push(F,g),!ke){console.error("Load value: Unknown enum label value.....");return}let ot=s.get(N(ke.name,C)).indivisibles.mapTrail.get(a[0]);e.push(i,...l(ot.address)),e.push(H);let $e=s.get(N(ot.data.name,ot.data.path)),{load:It}=$e.link;e.push(It.opcode,It.align,It.offset),nt();return}let{indivisibles:S}=f,{mapTrail:m}=S,L=JSON.parse(JSON.stringify(a)),v=m.get(a[0]),{address:ne}=v,Pe=[ne],oe=f;for(;L.length>0;){let Te=L.shift();if(L.length>0){let ke=oe.members.get(Te),xt=N(ke.name,ke.path);if(oe=s.get(xt),oe.indivisibles){let{indivisibles:ot}=oe,{mapTrail:$e}=ot,It=$e.get(L[0]),{address:Mt}=It;Pe.push(Mt)}continue}oe=oe.members.get(Te)}let Ve=N(oe.name,oe.path),ae=s.get(Ve),be=Ce.get(z);for(e.push(tt,...l(be));Pe.length>1;){let Te=Pe.shift();e.push(i,...l(Te)),e.push(H),e.push(st,fe,ue)}if(e.push(i,...l(Pe[0])),e.push(H),oe.type===q||oe.layout===q)e.push(le,g),e.push(F,g),e.push(i,...l(_t)),e.push(H),e.push(F,g),e.push(i,...l(Tt)),e.push(H),e.push(F,g);else if(oe.name===re){if(e.push(le,g),n===es){Ye(),Ne(oe,1),e.push(i,0),e.push(i,0);return}e.push(F,g),e.push(i,...l(Tt)),e.push(H),e.push(F,g)}else if(ae.type===de)e.push(le,g),e.push(F,g),e.push(i,...l(Tt)),e.push(H),e.push(F,g);else if(ae.type===at)e.push(le,g),e.push(F,g),e.push(st,fe,ue),e.push(F,g),e.push(st,fe,ue),e.push(F,g),e.push(st,fe,ue);else if(ae.link){let{link:Te}=ae,{load:ke}=Te;e.push(ke.opcode,ke.align,ke.offset)}else throw Error("Unhandled Case: Could read to program not running!!!!");break}}},je=k=>{let{name:T,currentIndex:K}=k;if(K===0)e.push(Ct,Ce.size+1);else if(e.push(tt,Ce.size+1),T==="==")e.push(qp);else if(T==="!=")e.push($p);else throw new Error(`Unknown operator ${T} for objects`)},Ze=k=>{let{member:T}=k,{isObject:K,index:B,address:G}=T;if(K){e.push(tt,...l(B)),e.push(i,...l(G)),e.push(H),e.push(tt,...l(B)),e.push(i,...l(G+Tt)),e.push(H);return}e.push(tt,...l(B)),e.push(i,...l(G)),e.push(H)};for(b(t);p.length>0;){let k=p.shift();switch(k.type){case"call":{ee(k);break}case"value":{ie(k);break}case ds:{Ze(k);break}case jo:{je(k);break}}}return o},Xt=t=>{let n=(p,_)=>{for(;p<_;)_=_-1|0,e.push(Ct,_)},o=(p,_)=>{if(yt(_,!0)){n(p,p+1|0);return}switch(_.type){case Bt:{_.name===q?n(p,p+Et|0):_.name===re?n(p,p+Kt|0):n(p,p+Ts|0);break}case re:{n(p,p+Kt|0);break}case q:{n(p,p+Et|0);break}case Qt:case St:{let{name:b,path:R}=_,j=N(b,R),U=s.get(j);switch(b){case re:{n(p,p+2|0);break}case q:{n(p,p+Number(_.quantity.capacity.literal)|0);break}default:{switch(U.type){case He:{b===re?n(p,p+2|0):n(p,p+1|0);break}case at:{n(p,p+3|0);break}case de:{n(p,p+2|0);break}}break}}break}}};switch(t.type){case Je:{let{name:p}=t,_=Ce.get(p),b=Fe.get(p),{data:R}=b;o(_,R);break}case Pt:{let{value:p,trail:_}=t,{name:b}=p,R=Fe.get(b),{data:j}=R,U=N(j.name,j.path),x=s.get(U),{indivisibles:ee}=x,{mapTrail:ie}=ee,je=_.join("."),Ze=JSON.parse(JSON.stringify(_)),k=ie.get(je),{index:T}=k,K=x;for(;Ze.length>0;){let G=Ze.shift();K=K.members.get(G)}let B=Ce.get(b);K.type==q?n(B+T|0,B+T+Et|0):K.type==re?n(B+T|0,B+T+Kt|0):n(B+T|0,B+T+1|0);break}}},y=(t,n)=>{let{array:o,index:p}=t;me=!0;let _=0,b=Ce.get(o.name),R=()=>{e.push(tt,b)},j=Fe.get(qe(o)),{data:U}=j,{name:x,path:ee}=U,ie=N(x,ee),je=s.get(ie);switch(je.type){case He:{R(),I(p);let{link:Ze}=je,{store:k}=Ze;e.push(i,k.size),e.push(Me),e.push(H);let T=Ie(n);I(n),T.mutable&&e.push(st,fe,ue),e.push(k.opcode,k.align,k.offset),_=_+4|0;break}case de:{R(),I(p),e.push(i,Yt),e.push(Me),e.push(H),e.push(le,g),e.push(F,g),e.push(F,g),e.push(i,Yt),e.push(H),I(n),e.push(Be,fe,ue),e.push(Be,fe,ue),_=_+4|0;break}}return _},u=(t,n)=>{let{value:o,trail:p}=t,{name:_}=o;me=!0;let b=Fe.get(_),{data:R}=b,j=N(R.name,R.path),U=s.get(j),{indivisibles:x}=U,{mapTrail:ee}=x,ie=p.join("."),je=JSON.parse(JSON.stringify(p)),Ze=ee.get(ie),{address:k}=Ze,T=U;for(;je.length>0;){let G=je.shift();if(je.length>0){let Z=T.members.get(G),M=N(Z.name,Z.path);T=s.get(M);continue}T=T.members.get(G)}let K=N(T.name,T.path),B=s.get(K);switch(B.type){case He:{let{link:G}=B,{store:Z}=G,M=Ce.get(_);e.push(tt,...l(M)),e.push(i,...l(k)),e.push(H),I(n),e.push(Z.opcode,Z.align,Z.offset);break}}},P=(t,n)=>{let{link:o}=t;me=!0;let p=0,{name:_,path:b,layout:R}=Ie(o),j=N(_,b),U=s.get(j);if(_===q||R===q){I(o),e.push(_e),e.push(le,g);let x=Ce.get(qe(o));I(n),e.push(Ct,x+2|0),e.push(Ct,x+1|0),e.push(Ct,x),e.push(F,g),e.push(et,Ln),Oe("dealloc")}else if(_===re){I(o),e.push(_e),e.push(le,g);let x=Ce.get(qe(o));I(n),e.push(Ct,x+1|0),e.push(Ct,x),e.push(F,g),e.push(et,Ln),Oe("dealloc");return}switch(U.type){case He:{I(o),I(n);let{link:x}=U,{store:ee}=x;e.push(ee.opcode,ee.align,ee.offset),p=p+1|0;break}case de:{let x=0,ee=(G,Z,M="")=>{let Ne=M?`${M}.${G.name}`:G.name,X=Z.get(Ne);if(X){let{data:Q}=X,Ue=N(Q.name,Q.path),O=s.get(Ue),{store:a}=O.link;I(o),e.push(_e),e.push(i,...l(X.address)),e.push(H),I(G.value),e.push(a.opcode,a.align,a.offset)}else if(G.value&&G.value.literal)for(let Q of G.value.literal)ee(Q,Z,Ne)};if(n.type===Je){let{name:G}=n;if(x=Ce.get(G),t.link.name.startsWith(ds)){let Z=Ce.get(t.link.name),{name:M,path:Ne}=Fe.get(G),X=N(M,Ne),Q=s.get(X),{indivisibles:Ue}=Q,{mapTrail:O}=Ue;for(let a of O){let{data:z}=a,E=N(z.name,z.path),C=s.get(E),{load:f,store:S}=C.link;e.push(i,...l(Z)),e.push(i,...l(a.address)),e.push(H),e.push(i,...l(x)),e.push(i,...l(a.address)),e.push(H),e.push(f.opcode,f.align,f.offset),e.push(S.opcode,S.align,S.offset)}return}return I(o),e.push(_e),e.push(tt,...l(x)),e.push(Be,fe,ue),I(o),e.push(_e),e.push(i,...l(Tt)),e.push(H),e.push(tt,...l(x+1|0)),e.push(Be,fe,ue),p=p+2|0,p}let{literal:ie,name:je,path:Ze}=n,k=N(je,Ze),T=s.get(k),{indivisibles:K}=T,{mapTrail:B}=K;for(let G of ie)ee(G,B)}}return p},Y=(t,n)=>{let{type:o,link:p}=n,_=0,b=ee=>{let ie=Array.from(ee.members.values()).reduce((K,B)=>B?K+1:K,0);ut();let{indivisibles:je}=ee,{mapTrail:Ze}=je,k=(K,B)=>{let{store:G,load:Z}=K.link,{address:M}=Ze.get(B);e.push(i,...l(G.size)),$(),I(p),e.push(_e),e.push(i,...l(M)),e.push(H),e.push(Z.opcode,Z.align,Z.offset),e.push(G.opcode,G.align,G.offset)},T=(K,B)=>{e.push(i,...l(_t)),$(),e.push(le,Le);for(let[Z,M]of K.members){if(!M)continue;let Ne=N(M.name,M.path),X=s.get(Ne);if(X.type===de){Ye(),T(X,`${B}.${Z}`);continue}let Q=`${B}.${Z}`;k(X,Q)}e.push(F,Le),e.push(F,Le),e.push(i,...l(_t)),e.push(H),e.push(Be,fe,ue);let G=Array.from(K.members.values()).reduce((Z,M)=>M?Z+1:Z,0);e.push(F,Le),e.push(i,...l(Tt)),e.push(H),e.push(i,...l(G)),e.push(Be,fe,ue),nt()};for(let[K,B]of ee.members){if(!B)continue;let G=N(B.name,B.path),Z=s.get(G);if(Z.type===de){T(Z,K);continue}k(Z,K)}e.push(F,g),e.push(i,...l(ie))},{name:R,path:j}=Ie(p||n),U=N(R,j),x=s.get(U);switch(x.type){case He:case de:{if(t.type===Je)return b(x),Xt(t),_;break}}return _},J=(t,n,o)=>{let p=s.get(t),_=R=>{switch(R.type){case Je:{let{name:j}=R,U=Ce.get(j);e.push(tt,U);break}case ve:{let{literal:j}=R,U=p.type===He?j:p.evaluate(j),x=l(U);e.push(i,...x);break}}},b=()=>{switch(p.type){case at:case He:{e.push(Xo),e.push(ns,0);break}}};switch(p.type){case at:{I(n),e.push(_e),e.push(_e),I(o),e.push(_e),e.push(_e),b();break}case He:{I(n),I(o),b();break}}},w=[],W=t=>{let n={type:Vo,statement:t};w.unshift(n)},ye=()=>{let t={type:Ho};w.unshift(t)};w.unshift({type:zt});let ze=(t,n)=>{if(t.members)for(let[o,p]of t.members.entries()){let _=N(p?.name,p?.path),b=s.get(_);if(b&&b.type===de){let R=ze(b,_,n);R&&he.push(R)}}return t.members&&t.members.has(vo)?n:null},he=[];Vt.forEach(t=>{let n=N(t.data.name,t.data.path),o=s.get(n);if(o&&o.type===de){let p=ze(o,n);p&&he.push(p)}});let xe=he.map(t=>({type:Do,expression:{type:Lt,name:vo,path:t,inputs:[]}}));for(let t of xe)W(t);var Ee=xs.length-1|0;for(let t=Ee;t>=0;t=t-1|0){let n=xs[t];W(n)}let we=t=>{let{target:n,source:o}=t;if(D.optimization){if(o.type===ve&&o.path===Qe){let b=qe(n);b&&Dt.set(b,{target:n,source:o})}o.type!==ve&&Dt.get(n.name||"")&&Dt.delete(n.name)}if(n.type===Fo){P(n,o);return}if(n.type===Up){y(n,o);return}if(n.type===Pt){u(n,o);return}let p,_=Ie(o);if(_&&(p=s.get(N(_.name,_.path))),p&&p.type===de&&_.type!==ve){let b=o;if(o.type===Vs){I(o.link),Xt(n);return}b={type:"value_copy",link:o},Y(n,b);return}I(o,es),Xt(n)},Ge=t=>{let{statements:n}=t;e.push(jt,Xe),e.push(Gt,Xe);let o={type:zt,layout:bs};w.unshift(o),w.unshift(o),w.unshift({type:wo});var p=n.length-1|0;for(let _=p;_>=0;_=_-1|0){let b=n[_];W(b)}},rs=t=>{let{statements:n,condition:o}=t;e.push(jt,Xe),e.push(Gt,Xe);let p={type:zt,layout:bs};w.unshift(p),w.unshift(p),w.unshift({type:Cn,condition:o});var _=n.length-1|0;for(let b=_;b>=0;b=b-1|0){let R=n[b];W(R)}},vt=t=>{let{statements:n,collection:o,index:p,iterator:_}=t;e.push(i,0),p?e.push(Ct,Ce.get(p)):e.push(le,g),e.push(jt,Xe),e.push(Gt,Xe);let b={type:zt,layout:bs};w.unshift(b),w.unshift(b),w.unshift({type:Ko,index:p});var R=n.length-1|0;for(let j=R;j>=0;j=j-1|0){let U=n[j];W(U)}w.unshift({type:Bo,collection:o,iterator:_,index:p})},De=t=>{let{statements:n}=t;t.initializer&&we(t.initializer),e.push(jt,Xe),e.push(Gt,Xe);let o={type:zt,layout:bs};w.unshift(o),w.unshift(o);let p={type:Lt,name:t.modifier===ko?"<=":t.modifier===Lo?"<":t.modifier===vp?">=":t.modifier===Mp?">":"",path:Qe,inputs:[t.variable,t.limit]};w.unshift({type:Cn,condition:p});let _={type:Lt,name:t.modifier===ko||t.modifier===Lo?"+":"-",path:Qe,inputs:[t.variable,t.step]},b={type:Ro,source:_,target:t.variable};W(b);var R=n.length-1|0;for(let j=R;j>=0;j=j-1|0){let U=n[j];W(U)}},qs=t=>{e.push(ss,2)},is=t=>{let{branches:n}=t;w.unshift({type:zt});for(let o=n.length-1;o>=0;o--){let p=n[o];switch(p.type){case Po:{let{statements:_}=p,b=_.length;for(let j=b-1;j>=0;j--){let U=_[j];W(U)}let R=_.find(j=>j.type===Ys);w.unshift({type:Ls,stop:R}),I(p.values[0]);break}case zo:{let{statements:_}=p,b=_.length;for(let R=b-1;R>=0;R--){let j=_[R];W(j)}w.unshift({type:jn});break}}}},Wt=(t,n)=>{w.unshift({type:zt});let o=n[0];if(n.length>=2){if(n[1].type===Po)Wt(t,n.slice(1));else if(n[1].type===zo){let{statements:x}=n[1],ee=x.length;for(let ie=ee-1;ie>=0;ie--)W(x[ie])}}let{statements:p}=o;w.unshift({type:jn});let _=p.length;for(let x=_-1;x>=0;x--)W(p[x]);let b=p.find(x=>x.type===Ys),R=Object.freeze({type:Ls,stop:b});w.unshift(R);let U=Object.freeze({type:Zo,function:()=>{let{name:x,path:ee}=Ie(t);s.get(N(x,ee)).type===at?(I(t),e.push(_e),e.push(_e),I(o.value),e.push(_e),e.push(_e),e.push(gs)):(I(t),I(o.value),e.push(gs))}});w.unshift(U)},$s=t=>{let{value:n,matches:o}=t;Wt(n,o)},Is=t=>{let n=t,{branches:o,values:p}=n;if(o.length>0&&p.length===0)return is(t);e.push(jt,Xe);let b={type:zt};w.unshift(b);let R=[];for(let U of p)switch(U.type){case Je:{let{name:x}=U,ee=Fe.get(x),{data:ie}=ee,{name:je,path:Ze}=ie,k=N(je,Ze);R.push(k);break}}var j=o.length-1|0;for(let U=j;U>=0;U=U-1|0){let x=o[U],ee={type:Yo,branch:x,condition:n,commonKeys:R};w.unshift(ee)}},As=t=>{let{expression:n}=t;var p=I(n)|0;for(let _=0;_<p;_=_+1|0)e.push(_e)},it=t=>{let{value:n}=t;I(n),e.push(et,Ln),Oe("dealloc"),e.push(i,0),Xt(n)},Js=t=>{let{values:n}=t;for(let o of n)I(o);e.push(Jp)},Qs=()=>{e.push(sl)},qn=t=>{e.push(Ht)},d=t=>{e.push(12,0)},A=t=>{e.push(Qp)},V=t=>{t.stop?(e.push(qo),e.push(pt)):(e.push(qo),e.push(Xe))},Se=t=>{let{branch:n,commonKeys:o,condition:p}=t,{values:_}=n,{values:b}=p;var R=o.length|0;for(let x=0;x<R;x=x+1|0){let ee=o[x],ie=_[x],je=b[x];J(ee,ie,je)}let{statements:j}=n;var U=j.length-1|0;for(let x=U;x>=0;x=x-1|0){let ee=j[x];W(ee)}},se=t=>{let{condition:n}=t;I(n);let o=Ie(n);if(o?.mutable){let p=N(o.name,o.path),_=s.get(p),{load:b}=_.link;e.push(b.opcode,b.align,b.offset)}e.push(i,0),e.push(gs),e.push(ns,1),e.push(ss,0)},Ae=t=>{let{collection:n,iterator:o,index:p}=t;I(n),e.push(_e),me=!0;let _=Ce.get(p);p?e.push(tt,_):e.push(F,g),e.push(gs),e.push(ns,1),e.push(_e);let b=Object.freeze({type:ws,array:n,index:{type:Je,name:p}}),R=Object.freeze({type:Je,name:o}),j=Object.freeze({type:Ro,target:R,source:b});W(j)},te=t=>{let{index:n}=t,o=Ce.get(n);n?e.push(tt,o):e.push(F,g),e.push(i,1),e.push(H),n?e.push(Ct,o):e.push(le,g),e.push(ss,0)},rt=t=>{let{statement:n}=t;switch(n.type){case"assign":{we(n);break}case Ls:{Is(n);break}case Gp:{$s(n);break}case bs:{Ge(n);break}case kp:{rs(n);break}case Lp:{vt(n);break}case Vp:{De(n);break}case Yp:{qs(n);break}case Do:{As(n);break}case wp:{it(n);break}case Ys:{Js(n);break}case Xp:{Qs();break}default:throw new Error(`can not handle statement type ${n.type}`)}};for(;w.length>0;){let t=w.shift();switch(t.type){case zt:{qn(t);break}case wo:{d(t);break}case jn:{A(t);break}case Ls:{V(t);break}case Yo:{Se(t);break}case Vo:{rt(t);break}case Cn:{se(t);break}case Bo:{Ae(t);break}case Ko:{te(t);break}case Ho:{e.push(jt,Xe);break}case Zo:{t.function();break}default:break}}return{totalOctets:e,nativeImports:pe,loads:me}}var{ENUM_MEMORY_SIZE:gl,ENUM_STACK_SIZE:sc,ARRAY_MEMORY_SIZE:yl,ARRAY_STACK_SIZE:wn,STRING_MEMORY_SIZE:xl,STRING_STACK_SIZE:Vn,OBJECT_MEMORY_SIZE:Xu,OBJECT_STACK_SIZE:nc,NATIVE_MEMORY_SIZE:Wu,NATIVE_STACK_SIZE:oc,NATIVE_SIZE:qu,STEP:$u,DOUBLE_STEP:Il,TRIPPLE_STEP:Ju}=Rt.Sizes,{HEX_ENCODE:vn,LEB128_ENCODE:Nt}=Jt,{TYPES_ASSIGN:Mn,TYPES_ARRAY:wt,TYPES_DATA:Bs,TYPES_GENERICS:Al,TYPES_ENUMERATION:Zt,TYPES_EXPRESSION:Nl,TYPES_LINK:Ks,TYPES_LOCAL:os,TYPES_OBJECT:Ft,TYPES_PROCEDURE:Bn,TYPES_RETURN:cc,TYPES_SELECT:Rl,TYPES_ARRAY_ACCESS:ac,TYPES_ARRAY_ASSIGNMENT:rc,TYPES_MEMBER:ic,TYPES_STORE:Kn,TYPES_LITERAL:pc,TYPES_LINK_TO:Gs,TYPES_VALUE_AT:Hs,TYPES_SELF:lc,TYPES_NATIVE:cs,TYPES_STRING:as,TYPES_CONDITION:Sl,TYPES_BRANCH_MATCH:uc,TYPES_WHILE:Pl,TYPES_WHEN:zl,TYPES_FOR:jl,TYPES_FOREACH:Cl,TYPES_SIZE:fc,TYPES_DROP:Fl,TYPES_CONCAT:Dl,TYPES_UNREACHABLE:Ul}=Ns,Gn="",We=(c,s)=>`${s}.${c}`,kl=c=>[">","<",">=","<=","!=","=="].includes(c),Ll=c=>["FP64","I64","U64","FP32","I32","U32","I16","U16","I8","U8","Bool"].includes(c),Hn=48,Yl=Object.freeze([0,127]),wl=Object.freeze({}),Vl=Object.freeze([127]),hc=0;var vl=2;var Ml=10,Bl=7,Kl=3,Gl=2,Hl=1,Zl=6,Ot=96,gt=127,Zn=Object.freeze([7,105,109,112,111,114,116,115]),Xl=Object.freeze([6,109,101,109,111,114,121]),Wl=0;var ql=65,bt=new Uint8Array(8),$l=Object.freeze([0,97,115,109]),Jl=Object.freeze([1,0,0,0]),Ql=(c,s)=>{s=s??wl;let r={},{data:h,code:D}=c,ce=D.filter(y=>!y.description.generics||y.description.generics.length===0),e=new Map,pe=new Map,me=y=>{let u=0;for(let P of y){let{data:Y}=P;switch(Y.type){case"Maybe":case Bs:{let{name:J,path:w}=Y,W=We(J,w),ye=e.get(W);if(!ye)console.error("No shape found for key:",W);else switch(ye.type){case cs:if(J===as){u=u+Vn|0;break}case Zt:{u=u+sc|0;break}case Ft:{u=u+nc|0;break}}break}case Ks:{let J=e.get(We(Y.name,Y.path));Y.name===as?u=u+Vn|0:Y.name===wt?u=u+wn|0:J.type===Ft?u=u+nc|0:u=u+oc|0;break}case wt:{u=u+wn|0;break}}}return u},Oe=(y,u)=>{let{labels:P}=u,Y=new Map,J=[];var w=P.length|0;for(let he=0;he<w;he=he+1|0){let{name:xe,props:Ee}=P[he];if(Ee.length>0){let we={type:Ft,name:xe,path:y,description:{members:Ee,generics:[]}};h.push(we),J.push({name:xe,props:Ee.map(Ge=>Ge.name)})}Y.set(xe,he)}return Object.freeze({type:Zt,encode:he=>{let xe=Y.get(he);return typeof xe>"u"?Vl:Nt(xe)},evaluate:he=>Y.get(he),opcode:ql,labels:J,link:Object.freeze({load:Object.freeze({opcode:40,align:2,offset:0,size:4}),store:Object.freeze({opcode:54,align:2,offset:0,size:4})})})},$=y=>{let u=[],P=[],Y=0,J=()=>{let d=Object.freeze({type:"back"});u.unshift(d)},w=d=>{let A={type:Bs,data:d};u.unshift(A)},W=d=>{let A={type:"name",name:d};u.unshift(A)},ye=(d,A)=>{A&&(J(),w(A),W(d))},ze=d=>h.find(A=>A.name===d),he=(d,A)=>A.find(V=>V.name===d),xe=(d,{inputs:A})=>A.find(V=>V.name===d),Ee=(d,A)=>{let V=d;for(let Se of A){let se=he(Se,V.description.members),Ae=ze(se.data.name);if(Ae&&Ae.type===Ft)V=Ae;else return se}return null},we=(d,A)=>{let V=d.trail,Se=he(V[0],A.members);if(!Se)return null;if(V.length===1)return Se.data;let se=ze(Se.data.name);return Ee(se,V.slice(1)).data},Ge=(d,A,V,Se)=>{if(xe(A,V.description))return;V.description.self.push(d);let se=Object.seal({name:A,data:{...we({trail:d.trail||d.value?.trail||d.link?.trail||[]},Se)}});d.type!==Gs&&(se.data.type=Ks),V.description.inputs.push(se)},rs=(d,A,V)=>{let Se=d.inputs.map(Ae=>De(Ae,A,V)),se=typeof d.name=="object"&&d.name[0]===ic?d.name.slice(1).join("_"):d.name;return{...d,name:se,inputs:Se}},vt=(d,A,V)=>{if(!(d.value.link===lc||d.value.value===lc))return d;let Se=`${d.type}_${d.trail.join("_")}`;if(Ge(d,Se,A,V),d.value.value)return{type:Gs,value:Se};if(d.value.link)return{type:Hs,link:Se}},De=(d,A,V,Se="")=>{switch(d.type){case os:case pc:return d;case ic:{let se=`${d.type}_${d.trail.join("_")}`;return Ge(d,se,A,V),Se==="target"?{type:Kn,link:{type:os,name:se}}:{type:Hs,link:{type:os,name:se}}}case Gs:{if(d.value.type===pc)return d.value;{let se=`${d.value.type}_${d.value.trail.join("_")}`;return Ge(d,se,A,V),{type:Gs,value:{type:os,name:se}}}}case Hs:{let se=`${d.link.type}_${d.link.trail.join("_")}`;return Ge(d,se,A,V),{type:Hs,link:{type:os,name:se}}}case Kn:{let se=`${d.link.type}_${d.link.trail.join("_")}`;return Ge(d,se,A,V),{type:Kn,link:{type:os,name:se}}}case Rl:return vt(d,A,V);case Nl:return rs(d,A,V);case ac:{let se=De(d.array,A,V),Ae=De(d.index,A,V);return Object.freeze({type:ac,index:Ae,array:se})}case rc:{let se=De(d.array,A,V),Ae=De(d.index,A,V);return Object.freeze({type:rc,index:Ae,array:se})}case fc:{let se=De(d.value,A,V);return Object.freeze({type:fc,value:se})}case Dl:{let se=d.values.map(Ae=>De(Ae,A,V));return Object.freeze({...d,values:se})}default:throw Error(`Unhandled type(checkObjectValues): ${d.type}`)}},qs=(d,A)=>{let V=JSON.parse(JSON.stringify(d));V.description.self=[];let Se=Ae=>{Ae.type===Mn?(Ae.target=De(Ae.target,V,A,"target"),Ae.source=De(Ae.source,V,A)):Ae.type===cc&&(Ae.values=Ae.values.map(te=>De(te,V,A)))},se=Ae=>{Ae.forEach(te=>{if(te.type===Mn||te.type===cc)Se(te);else if(te.type===Sl)te.branches.forEach(rt=>{se(rt.statements),rt.type===uc&&(rt.values=rt.values.map(t=>De(t,V,A)))});else if(te.type===Pl)te.condition=De(te.condition,V,A),se(te.statements);else if(te.type===zl)te.value=De(te.value,V,A),te.matches.forEach(rt=>{rt.type===uc&&(rt.value=De(rt.value,V,A)),se(rt.statements)});else if(te.type===jl)te.limit=De(te.limit,V,A),te.variable=De(te.variable,V,A),te.initializer.type===Mn&&(te.initializer.target=De(te.initializer.target,V,A),te.initializer.source=De(te.initializer.source,V,A)),te.step=De(te.step,V,A),se(te.statements);else if(te.type===Cl)te.collection=De(te.collection,V,A),se(te.statements);else if(te.type===Fl)te.expression=De(te.expression,V,A);else if(te.type!==Ul)throw new Error("unhandled statement type: ",te.type)})};se(V.description.statements),ce.push(V)},{members:is}=y,Wt=new Map;for(let d of is){let{name:A,data:V,value:Se}=d;Wt.set(A,V),Se&&Wt.set(A,{...V,value:Se})}var $s=is.length-1|0;for(let d=$s;d>=0;d=d-1|0){let A=is[d],{name:V,data:Se}=A;if(A.type&&A.type===Bn){qs(A,y);continue}ye(V,Se)}let Is=new Map,As=new Map,it=0;for(;u.length>0;){let d=u.shift();switch(d.type){case"back":{P.pop();break}case Bs:{let{data:A}=d,V=()=>{let rt=P.join("."),t=We(A.name,A.path),n=e.get(t),{link:o}=n,p=Object.freeze({data:A,index:it,address:Y,trail:rt}),_=e.get(We(A.name,A.path));A.name===as?Y+=xl:A.type===wt||A.layout===wt?Y+=yl:_.type===Zt?Y+=gl:Y+=o?.load.size||Il,Is.set(rt,p),As.set(it,p),A.name===as?it=it+Vn|0:A.type===wt||A.layout===wt?it=it+wn|0:_.type===Zt?it=it+sc|0:it=it+oc|0};if(A.type===Ks){V();break}let{name:Se,path:se}=A,Ae=We(Se,se),te=e.get(Ae);if(!te)throw new Error("Shape not found: ",Ae);switch(te.type){case cs:{V();break}case Zt:{V();break}case Ft:{V();break}}break}case"name":{let{name:A}=d;P.push(A);break}}}let Js=it|0,Qs=Object.freeze({mapTrail:Is,mapIndex:As});return{type:Ft,length:Js,members:Wt,indivisibles:Qs}},Re={};for(let y of h){let{path:u}=y;switch(y.type){case cs:{let{name:P,path:Y}=y,J=We(P,Y);if(Object.hasOwn(kt,J)){let w=kt[J];e.set(J,w);continue}break}case"import":{if(Object.hasOwn(kt,u)){let P=kt[u];e.set(u,P);continue}break}case Al:{let{name:P,path:Y}=y,J=We(P,Y),w=kt["Flogram.FP32"];e.set(J,w);break}case Zt:{let{name:P,path:Y,description:J}=y,w=We(P,Y),W=Oe(w,J);e.set(w,W);break}case Ft:{let{name:P,path:Y,description:J}=y,{generics:w}=J,W=We(P,Y);if(!w||w.length===0){let ye=$(J);e.set(W,ye)}break}}}r.structures=Re;let lt=0,ut=(y,u)=>{let P=pe.get(y);if(typeof P>"u"){pe.set(y,[u]);return}(P.length==0||P.length>0&&P[0].body!==u.body)&&pe.set(y,[u,...P])},Ye=y=>{let{name:u,path:P}=y,Y=We(u,P);switch(P==="Flogram"&&(Ll(u)?Y=We(y.description.inputs[0]?.data?.name?.toLowerCase()+"."+ct(u),P):y.description.outputs&&y.description.outputs.length>=1&&!kl(y.name)?y.description.outputs[0]?.data?.name&&(Y=We(y.description.outputs[0]?.data?.name?.toLowerCase()+"."+ct(u,y.description.inputs?.length),P)):(fs.includes(y.description.inputs[1]?.data?.name)&&(Y=We(y.description.inputs[1]?.data?.name+"."+ct(u),P),Gn=y.description.inputs[1]?.data?.name),Gn&&(Y=We(Gn.toLowerCase()+"."+ct(u),P)))),y.type){case cs:{if(Object.hasOwn(Os,Y)){let J=Os[Y];ut(Y,J);return}break}case Bn:{let{description:J}=y,{inputs:w,outputs:W}=J,ye=We(u,P),ze={type:"artificial",index:"artificial"+lt,procedure:y,lengths:Object.freeze({inputs:me(w),outputs:me(W)})};ut(ye,ze);break}}lt=lt+1|0},nt=[],dt=[];for(let y of ce){if(y.description.generics?.length>0)continue;let{description:u}=y,{inputs:P,outputs:Y}=u,J=[...P,...Y];if(!(y.type===cs&&J.some(w=>!fs.includes(w.data.name))))switch(Ye(y),y.type){case"import":{let{path:w}=y;if(Object.hasOwn(Os,w))continue;nt.push(y);break}case Bn:{dt.push(y);break}}}let ft=y=>{let u=0,P=[];for(let Y of y){let J=()=>{P.push(gt),u=u+1|0,P.push(gt),u=u+1|0,P.push(gt),u=u+1|0},w=we=>{let{identity:Ge}=we;P.push(Ge),u=u+1|0},W=()=>{P.push(gt),u=u+1|0},ye=()=>{P.push(gt),u=u+1|0,P.push(gt),u=u+1|0,P.push(gt),u=u+1|0},ze=()=>{P.push(gt),u=u+1|0,P.push(gt),u=u+1|0},he=()=>{P.push(gt),u=u+1|0,P.push(gt),u=u+1|0},{name:xe,data:Ee}=Y;switch(Ee.type){case"":case Bs:{let{name:we,path:Ge}=Ee,rs=We(we,Ge),vt=e.get(rs);if(!vt)w(kt["Flogram.FP32"]);else switch(vt.type){case cs:{we===as?he():w(vt);break}case Zt:{J();break}case Ft:{ze();break}}break}case Ks:{let we=e.get(We(Ee.name,Ee.path));Ee.name===wt?ye():Ee.name===as?he():we.type===Ft?ze():W();break}case wt:{ye();break}}}return[u,P]},yt=(y,u)=>{let P=u.length|0,Y=Nt(P);u.unshift(y,...Y)},Zs=y=>{let u=[],P=[...nt,...dt],Y=new Map([["alloc",[Ot,1,127,1,127]],["dealloc",[Ot,1,127,0]],["merge",[Ot,0,0]],["save",[Ot,2,127,127,0]],["undo",[Ot,0,2,127,127]],["undoPenultimate",[Ot,0,2,127,127]],["draw",[Ot,1,127,0]],["drawI64",[Ot,1,126,0]],["drawFP32",[Ot,1,125,0]],["drawFP64",[Ot,1,124,0]],["now",[Ot,0,1,126]]]);for(let W of y)if(Y.has(W))u.push(...Y.get(W));else throw new Error("Procedure not found:",W);for(let W of P){let{description:ye}=W,{inputs:ze,outputs:he}=ye,[xe,Ee]=ft(ze),[we,Ge]=ft(he);u.push(Ot,xe,...Ee,we,...Ge)}let J=P.length|0,w=Nt(J+y.size);return u.unshift(...w),yt(Hl,u),u},Xs=y=>{let u=[];return y&&y.size>0&&(u.push(2),u.push(127,1),u.push(65,0,11),u.push(127,1),u.push(65,0,11),yt(Zl,u)),u},Vt=0,xs=(y,u)=>{let P=[],Y=0,J={};if(s.memory){let ye=xe=>{let Ee=[...xe].map(we=>we.charCodeAt(0));return[Ee.length,...Ee]},ze=[];(u||y.size>0)&&(J.memory={path:"memory",description:{inputs:[],outputs:[]}});for(let xe of y)ze.push(ye(xe)),J[xe]={path:xe,description:{inputs:[],outputs:[]}};let he=Array.from(y);for(let xe of y)bt.fill(Hn),vn(Y,bt),P.push(...Zn,...ze[he.indexOf(xe)],hc,he.indexOf(xe)),Y=Y+1|0}for(let ye of nt){bt.fill(Hn),vn(Y,bt);let ze=String.fromCodePoint(...bt);J[ze]={path:ye.path,description:ye.description};let he=Y|0;P.push(...Zn,bt.length|0,...bt,hc,he),Y=Y+1|0}Vt=Y|0,(u||y.size>0)&&(P.push(...Zn,...Xl,vl,...Yl),Y=Y+1|0);let w=Y|0,W=Nt(w);return P.unshift(...W),yt(Gl,P),r.imports=J,P},Ce=()=>{let y=[];var u=dt.length|0;for(let J=0;J<u;J=J+1|0){let w=J|0,W=Vt+w|0,ye=Nt(W);y.push(...ye)}let P=dt.length|0,Y=Nt(P);return y.unshift(...Y),yt(Kl,y),y},Fe=()=>{let y=[],u=0,P={};var Y=dt.length|0;for(let W=0;W<Y;W=W+1|0){let ye=W+Vt|0,ze=Nt(ye);bt.fill(Hn),vn(u,bt);let{name:he,path:xe,description:Ee}=dt[W];Ee={inputs:Ee.inputs,outputs:Ee.outputs};let we=String.fromCodePoint(...bt);P[we]={name:he,path:xe,description:Ee},y.push(bt.length|0,...bt,Wl,...ze),u=u+1|0}let J=u|0,w=Nt(J);return y.unshift(...w),yt(Bl,y),r.procedures=P,y},Dt=()=>{let y=[],u=new Set,P=!1;for(let W of dt){let{totalOctets:ye,nativeImports:ze,loads:he}=Ms(W,e,pe,ce,s);u=new Set([...u,...ze]),he&&!P&&(P=he);let xe=ye.length|0,Ee=Nt(xe);y.push(...Ee,...ye)}let Y=dt.length|0,J=Nt(Y);return y.unshift(...J),yt(Ml,y),y=((W,ye,ze)=>{let he=Array.from(ze),xe="artificial";return W.map(Ee=>{if(typeof Ee=="string"){if(Ee.startsWith(xe)){let we=Ee.slice(xe.length),Ge=parseInt(we,10);if(!isNaN(Ge))return Ge+ye}if(he.includes(Ee))return he.indexOf(Ee)}return Ee})})(y,u.size,u),{totalOctets:y,allImports:u,loads:P}},{totalOctets:ge,allImports:Ke,loads:Xn}=Dt(),Ws=Zs(Ke),qe=xs(Ke,Xn),Ie=Ce(),Wn=Xs(Ke),I=Fe(),Xt=new Uint8Array([...$l,...Jl,...Ws,...qe,...Ie,...Wn,...I,...ge]);return[r,Xt]},eu=Object.freeze({compile:Ql}),Qu=eu;export{Qu as default};
